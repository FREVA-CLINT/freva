
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>The Freva command line interface &#8212; freva user guide 2502.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/code-tabs.css?v=1bc26e2f" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css?v=2aa19091" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=e15c9e9f"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../_static/code-tabs.js?v=c983d12e"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/04-The_CommandLineInterface';</script>
    <link rel="icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Frequently Ask Questions and best practices" href="../FAQ.html" />
    <link rel="prev" title="Applying data analysis Plugins" href="03-Applying_Plugins_and_Search_for_History.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="freva user guide 2502.0.0 documentation - Home"/>
    <img src="../_static/logo.png" class="logo__image only-dark pst-js-only" alt="freva user guide 2502.0.0 documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../Freva.html">
    Freva python module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../FrevaCli.html">
    The Freva command line interface
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developers_guide.html">
    Plugin Developer Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>

            <li class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button"
                data-bs-toggle="dropdown" aria-expanded="false"
                aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../FAQ.html">
    Frequently Ask Questions and best practices
  </a>
</li>


<li class=" ">
  <a class="nav-link dropdown-item nav-internal" href="../whats-new.html">
    What’s new
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/FREVA-CLINT/freva" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../Freva.html">
    Freva python module
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../FrevaCli.html">
    The Freva command line interface
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../developers_guide.html">
    Plugin Developer Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Examples
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../FAQ.html">
    Frequently Ask Questions and best practices
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../whats-new.html">
    What’s new
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/FREVA-CLINT/freva" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01-Using_the_Databrowser.html">Searching for data: the databrowser method</a></li>
<li class="toctree-l1"><a class="reference internal" href="02-Add_own_datasets.html">Managing your own datasets: the UserData class</a></li>
<li class="toctree-l1"><a class="reference internal" href="03-Applying_Plugins_and_Search_for_History.html">Applying data analysis Plugins</a></li>

<li class="toctree-l1 current active"><a class="current reference internal" href="#">The Freva command line interface</a></li>



</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Examples</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">The Freva command line interface</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="The-Freva-command-line-interface">
<h1>The Freva command line interface<a class="headerlink" href="#The-Freva-command-line-interface" title="Link to this heading">#</a></h1>
<p>This notebook introduces the usage of the Freva command line interface - cli. The tutorial assumes that you have already access to Freva either because you’ve setup an instance yourself or one has been setup by the Freva admin team. Hence it is assumed that you know how to access Freva. If this is not the case please contact one of your Freva admins for help.</p>
<p>A general usage overview of the available Freva sub-commands is available via the –help option:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
usage: freva [-h] [-V] {plugin,esgf,databrowser,history,user-data} ...

Free EVAluation system framework (freva)

positional arguments:
  {plugin,esgf,databrowser,history,user-data}
                        Available sub-commands:
    plugin              Apply data analysis plugin.
    esgf                Search/Download ESGF the data catalogue.
    databrowser         Find data in the system.
    history             Read the plugin application history.
    user-data           Update users project data.

options:
  -h, --help            show this help message and exit
  -V, --version         show program&#39;s version number and exit

To get help for the individual sub-commands use: freva &lt;sub-command&gt; --help
</pre></div></div>
</div>
<p>The most common sub-commands are <code class="docutils literal notranslate"><span class="pre">databrowser</span></code> and <code class="docutils literal notranslate"><span class="pre">plugin</span></code>. You can get more help on the actual commands using the sub-commands <code class="docutils literal notranslate"><span class="pre">--help</span></code> option, for example getting help on the databrowser usage:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva<span class="w"> </span>databrowser<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
usage: freva databrowser [-h] [--multiversion] [--batch-size BATCH_SIZE]
                         [--count] [--facet FACET] [--facet-limit FACET_LIMIT]
                         [--time-select {flexible,strict,file}] [--debug]
                         [facets ...]

Find data in the system.

positional arguments:
  facets                Search facet(s). (default: None)

options:
  -h, --help            show this help message and exit
  --multiversion        Select not only the latest version. (default: False)
  --batch-size BATCH_SIZE
                        Number of files to retrieve. (default: 5000)
  --count               Show the number of files for each search result.
                        (default: False)
  --facet FACET         Retrieve values of given facet instead of files.
                        (default: None)
  --facet-limit FACET_LIMIT
                        Limit the number of output facets. (default:
                        9223372036854775807)
  --time-select {flexible,strict,file}
                        Operator that specifies how the time period is
                        selected. (default: flexible)
  --debug, -v, -d, --verbose
                        Use verbose output. (default: False)
</pre></div></div>
</div>
<p><strong>Note</strong>: Instead of using sub-commands you have also the option to use commands. For example the command <code class="docutils literal notranslate"><span class="pre">freva-databrowser</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">freva</span> <span class="pre">databrowser</span></code>, <code class="docutils literal notranslate"><span class="pre">freva-user-data</span></code> to <code class="docutils literal notranslate"><span class="pre">freva</span> <span class="pre">user-data</span></code> etc.</p>
<section id="Searching-for-data:-the-freva-databrowser-command">
<h2>Searching for data: the freva-databrowser command<a class="headerlink" href="#Searching-for-data:-the-freva-databrowser-command" title="Link to this heading">#</a></h2>
<p>All files available on in the project are scanned and indexed via a data search server. This allows you to query the server which responds almost immediately. To search for data you can either use the <code class="docutils literal notranslate"><span class="pre">freva-databrowser</span></code> command or the <code class="docutils literal notranslate"><span class="pre">freva</span> <span class="pre">databrowser</span></code> sub-command. Let’s inspect the help menu of the databrowser sub-command:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-databrowser<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
usage: freva-databrowser [-h] [--multiversion] [--batch-size BATCH_SIZE]
                         [--count] [--facet FACET] [--facet-limit FACET_LIMIT]
                         [--time-select {flexible,strict,file}] [--debug] [-V]
                         [facets ...]

Find data in the system.

positional arguments:
  facets                Search facet(s). (default: None)

options:
  -h, --help            show this help message and exit
  --multiversion        Select not only the latest version. (default: False)
  --batch-size BATCH_SIZE
                        Number of files to retrieve. (default: 5000)
  --count               Show the number of files for each search result.
                        (default: False)
  --facet FACET         Retrieve values of given facet instead of files.
                        (default: None)
  --facet-limit FACET_LIMIT
                        Limit the number of output facets. (default:
                        9223372036854775807)
  --time-select {flexible,strict,file}
                        Operator that specifies how the time period is
                        selected. (default: flexible)
  --debug, -v, -d, --verbose
                        Use verbose output. (default: False)
  -V, --version         show program&#39;s version number and exit
</pre></div></div>
</div>
<p>The databrowser expects a list of <code class="docutils literal notranslate"><span class="pre">key=value</span></code> pairs. The order of the pairs doesn’t really matter. Most important is that you don’t need to split the search according to the type of data you are searching for. You can search for any files, for example observations, reanalysis and model data at the same time. Also important is that all queries are case insensitive. You can also search for attributes themselves instead of file paths. For example you can search for the list of variables available
that satisfies a certain constraint (e.g. sampled 6hr, from a certain model, etc).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-databrowser<span class="w"> </span><span class="nv">project</span><span class="o">=</span>observations<span class="w"> </span><span class="nv">variable</span><span class="o">=</span>pr<span class="w"> </span><span class="nv">model</span><span class="o">=</span><span class="s1">&#39;cp*&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022300-201609022330.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022200-201609022230.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022100-201609022130.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022000-201609022030.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021900-201609021930.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021800-201609021830.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021700-201609021730.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021600-201609021630.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021500-201609021530.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021400-201609021430.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021300-201609021330.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021200-201609021230.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021100-201609021130.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609021000-201609021030.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020900-201609020930.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020800-201609020830.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020700-201609020730.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020600-201609020630.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020500-201609020530.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020400-201609020430.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020300-201609020330.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020200-201609020230.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020100-201609020130.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020000-201609020030.nc
</pre></div></div>
</div>
<p>In some cases it might be useful to know how many files are found in the <code class="docutils literal notranslate"><span class="pre">databrowser</span></code> for certain search constraints. In such cases you can use the <code class="docutils literal notranslate"><span class="pre">count</span></code> flag to count the number of found files instead of getting the files themselves.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-databrowser<span class="w"> </span><span class="nv">project</span><span class="o">=</span>observations<span class="w"> </span>--count
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
24
</pre></div></div>
</div>
<p>Sometimes it might be useful to subset the data you’re interested in by time. To do so you can use the time search key to subset time steps and whole time ranges. For example let’s get the for certain time range:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-databrowser<span class="w"> </span><span class="nv">project</span><span class="o">=</span>observations<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="s1">&#39;2016-09-02T22:15 to 2016-10&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022300-201609022330.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022200-201609022230.nc
</pre></div></div>
</div>
<p>The default method for selecting time periods is <code class="docutils literal notranslate"><span class="pre">flexible</span></code>, which means all files are selected that cover at least start or end date. The <code class="docutils literal notranslate"><span class="pre">strict</span></code> method implies that the entire search time period has to be covered by the files. Using the <code class="docutils literal notranslate"><span class="pre">strict</span></code> method in the example above would only yield on file because the first file contains time steps prior to the start of the time period:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-databrowser<span class="w"> </span><span class="nv">project</span><span class="o">=</span>observations<span class="w"> </span><span class="nv">time</span><span class="o">=</span><span class="s1">&#39;2016-09-02T22:15 to 2016-10&#39;</span><span class="w"> </span>--time-select<span class="w"> </span>strict
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022300-201609022330.nc
</pre></div></div>
</div>
<p>You might as well want to know about possible values that an attribute can take after a certain search is done. For this you use the <code class="docutils literal notranslate"><span class="pre">--facet</span></code> flag (facets are the attributes used to search for and sub set the data). For example to see all <code class="docutils literal notranslate"><span class="pre">facets</span></code> that are available in the observations project:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-databrowser<span class="w"> </span><span class="nv">project</span><span class="o">=</span>observations<span class="w"> </span>--all-facets
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
usage: freva-databrowser [-h] [--multiversion] [--batch-size BATCH_SIZE]
                         [--count] [--facet FACET] [--facet-limit FACET_LIMIT]
                         [--time-select {flexible,strict,file}] [--debug] [-V]
                         [facets ...]
freva-databrowser: error: Unknown option: --all-facets
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-databrowser<span class="w"> </span>--facet<span class="w"> </span>time_frequency<span class="w"> </span>--facet<span class="w"> </span>variable<span class="w"> </span><span class="nv">project</span><span class="o">=</span>observations
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
time_frequency: 30min
variable: pr
</pre></div></div>
</div>
<p>You can also retrieve information on how many facets are found by the databrowser by giving the <code class="docutils literal notranslate"><span class="pre">count</span></code> flag</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-databrowser<span class="w"> </span>--facet<span class="w"> </span>time_frequency<span class="w"> </span>--facet<span class="w"> </span>variable<span class="w"> </span><span class="nv">project</span><span class="o">=</span>observations<span class="w"> </span>--count
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
time_frequency: 30min (24)
variable: pr (24)
</pre></div></div>
</div>
</section>
</section>
<section id="Running-data-analysis-plugins:-the-freva-plugin-command">
<h1>Running data analysis plugins: the freva-plugin command<a class="headerlink" href="#Running-data-analysis-plugins:-the-freva-plugin-command" title="Link to this heading">#</a></h1>
<p>Already defined data analysis tools can be started with the <code class="docutils literal notranslate"><span class="pre">freva-plugin</span></code> command or the <code class="docutils literal notranslate"><span class="pre">freva</span> <span class="pre">plugin</span></code> sub-command. Let’s inspect the help menu of the plugin command:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-plugin<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
usage: freva-plugin [-h] [--repo-version] [--caption CAPTION] [--save]
                    [--save-config SAVE_CONFIG] [--show-config] [--batchmode]
                    [--unique-output {true,false,True,False}] [--debug]
                    [--list-tools] [--doc] [--json] [--wait] [-V]
                    [plugin_name] [tool-options ...]

Apply data analysis plugin.

positional arguments:
  plugin_name           Plugin name. (default: None)
  tool-options          Tool options (default: None)

options:
  -h, --help            show this help message and exit
  --repo-version        Show the version number from the repository. (default:
                        False)
  --caption CAPTION     Set a caption for the results (default: )
  --save                Save the plugin configuration to default destination.
                        (default: False)
  --save-config SAVE_CONFIG
                        Save the plugin configuration. (default: None)
  --show-config         Show the resulting configuration. (default: False)
  --batchmode           Create a Batch job and submit it to the scheduling
                        system. (default: False)
  --unique-output {true,false,True,False}, --unique_output {true,false,True,False}
                        Append a Freva run id to the output/cache folder(s).
                        (default: true)
  --debug, -v, -d, --verbose
                        Use verbose output. (default: False)
  --list-tools, --list, -l
                        Only list the available tools. (default: False)
  --doc, --plugin-doc   Display plugin documentation (default: False)
  --json, -j            Display a json representation of the result, this can
                        beuseful if you want to build shell based pipelines
                        and wantparse the output with help of `jq`. (default:
                        False)
  --wait, -w            Wait for the plugin to finish, this has only an effect
                        for batch mode execution. (default: False)
  -V, --version         show program&#39;s version number and exit
</pre></div></div>
</div>
<p>As the help menu suggests you can list all available tools using the <code class="docutils literal notranslate"><span class="pre">-l</span></code> option (or <code class="docutils literal notranslate"><span class="pre">--list</span></code>, <code class="docutils literal notranslate"><span class="pre">--list-tools</span></code>):</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-plugin<span class="w"> </span>-l
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
┏━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span class="ansi-bold"> </span><span class="ansi-bold">Tool              </span><span class="ansi-bold"> </span>┃<span class="ansi-bold"> </span><span class="ansi-bold">Description                         </span><span class="ansi-bold"> </span>┃
┡━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Animator           │ Animate data on lon/lat grids        │
│ DummyPlugin        │ A dummy plugin                       │
│ DummyPluginFolders │ A dummy plugin with outputdir folder │
└────────────────────┴──────────────────────────────────────┘
</pre></div></div>
</div>
<p>This means currently we have two plugins available (animator and dummyplugin). The general syntax is freva-plugin <code class="docutils literal notranslate"><span class="pre">&lt;plugin-name&gt;</span> <span class="pre">[options]</span></code> for example to inspect the documentation of a certain plugin you can use the <code class="docutils literal notranslate"><span class="pre">--doc</span></code> option. Here we concentrate on the Animator plugin. A simple plugin that creates animations of geospatial data. The basic usage of that command can be retrieved by:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-plugin<span class="w"> </span>--doc<span class="w"> </span>animator
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-bold">Animator</span> (v2022.7.15): Create animations (in gif or mp4 format) This tool
creates plots of solr facets and an animation.
┏━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃<span class="ansi-bold"> </span><span class="ansi-bold">Option                 </span><span class="ansi-bold"> </span>┃<span class="ansi-bold"> </span><span class="ansi-bold">Description                                       </span><span class="ansi-bold"> </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_file              │ NetCDF input file(s), you can choose multiple      │
│                         │ files separated by a , or use a global pattern for │
│                         │ multiple files chose this option only if you don&#39;t │
│                         │ want Freva to find files by seach facets (default: │
│                         │ &lt;null&gt;)                                            │
│ <span class="ansi-red-intense-fg ansi-bold">variable</span>                │ Variable name (only applicable if you didn&#39;t       │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ project                 │ Project name (only applicable if you didn&#39;t choose │
│                         │ an input file) (default: &lt;null&gt;)                   │
│ product                 │ Product name (only applicable if you didn&#39;t choose │
│                         │ an input file) (default: &lt;null&gt;)                   │
│ experiment              │ Experiment name (only applicable if you didn&#39;t     │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ institute               │ Institute name (only applicable if you didn&#39;t      │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ model                   │ Model name (only applicable if you didn&#39;t choose   │
│                         │ an input file) (default: &lt;null&gt;)                   │
│ time_frequency          │ Time frequency name (only applicable if you didn&#39;t │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ ensemble                │ Ensemble name (only applicable if you didn&#39;t       │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ start                   │ Define the first time step to be plotted, leave    │
│                         │ blank if taken from data (default: &lt;null&gt;)         │
│ end                     │ Define the last time step to be plotted, leave     │
│                         │ blank if taken from data (default: &lt;null&gt;)         │
│ time_mean               │ Select a time interval if time                     │
│                         │ averaging/min/max/sum should be applied along the  │
│                         │ time axis. This can be D for daily, M for monthly  │
│                         │ 6H for 6 hours etc. Leave blank if the time axis   │
│                         │ should not be resampled (default) or set to        │
│                         │ &lt;em&gt;all&lt;/em&gt; if you want to collapse the time      │
│                         │ axis. (default: &lt;null&gt;)                            │
│ time_method             │ If resampling of the time axis is chosen (default: │
│                         │ no) set the method: mean, max or min. &lt;b&gt;Note:&lt;/b&gt; │
│                         │ This has only an effect if the above parameter for │
│                         │ &lt;em&gt;time_mean&lt;/em&gt; is set. (default: mean)         │
│ lonlatbox               │ Set the extend of a rectangular lonlatbox          │
│                         │ (left_lon, right_lon, lower_lat, upper_lat)        │
│                         │ (default: &lt;null&gt;)                                  │
│ output_unit             │ Set the output unit of the variable - leave blank  │
│                         │ for no conversion. This can be useful if the unit  │
│                         │ of the input files should be converted, for        │
│                         │ example for precipitation. Note: Although many     │
│                         │ conversions are supported, by using the `pint`     │
│                         │ conversion library. (default: &lt;null&gt;)              │
│ vmin                    │ Set the minimum plotting range (leave blank to     │
│                         │ calculate from data 1st decile) (default: &lt;null&gt;)  │
│ vmax                    │ Set the maximum plotting range (leave blank to     │
│                         │ calculate the 9th decile) (default: &lt;null&gt;)        │
│ cmap                    │ Set the colormap, more information on colormaps is │
│                         │ available on the &lt;a                                │
│                         │ href=&#34;https://matplotlib.org/stable/tutorials/colo │
│                         │ rs/colormaps.html&#34; target=_blank&gt;matplotlib        │
│                         │ website&lt;/a&gt;. (default: RdYlBu_r)                   │
│ linecolor               │ Color of the coast lines in the map (default: k)   │
│ projection              │ Set the global map projection. Note: this should   │
│                         │ the name of the cartopy projection method (e.g     │
│                         │ PlatteCarree for Cylindrical Projection). Pleas    │
│                         │ refer to &lt;a                                        │
│                         │ href=&#34;https://scitools.org.uk/cartopy/docs/latest/ │
│                         │ crs/projections.html&#34;target=_blank&gt;cartopy         │
│                         │ website&lt;/a&gt; for details. (default: PlateCarree)    │
│ proj_centre             │ Set center longitude of the global map projection. │
│                         │ (default: 50)                                      │
│ pic_size                │ Set the size of the picture (in pixel) (default:   │
│                         │ 1360,900)                                          │
│ plot_title              │ Set plot title (default: )                         │
│ cbar_label              │ Overwrite default colorbar label by this value     │
│                         │ (default: )                                        │
│ suffix                  │ Filetype of the animation (default: mp4)           │
│ fps                     │ Set the frames per seceonds of the output          │
│                         │ animation. (default: 5)                            │
│ extra_scheduler_options │ Set additional options for the job submission to   │
│                         │ the workload manager (, separated). Note:          │
│                         │ batchmode and web only. (default: --qos=test,      │
│                         │ --array=20)                                        │
└─────────────────────────┴────────────────────────────────────────────────────┘
</pre></div></div>
</div>
<p>The parameters are also given as <code class="docutils literal notranslate"><span class="pre">key=values</span></code> pairs. But not all of the above parameters are mandatory. Let’s use one project search key and animate its content.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva<span class="w"> </span>plugin<span class="w"> </span>animator<span class="w"> </span><span class="nv">project</span><span class="o">=</span>observations<span class="w"> </span><span class="nv">variable</span><span class="o">=</span>pr<span class="w"> </span><span class="nv">cmap</span><span class="o">=</span>Blues<span class="w"> </span><span class="nv">fps</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="nv">output_unit</span><span class="o">=</span>mm/h<span class="w"> </span><span class="nv">vmin</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vmax</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="nv">suffix</span><span class="o">=</span>gif
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
/tmp/animator/run.py:91: SyntaxWarning: invalid escape sequence &#39;\d&#39;
  for i in re.findall(&#34;[-\d]+&#34;, unit[n]):
Setp 1: Collecting all files
Step 2: Opening the netcdf-files, collecting metadata
Step 3: Converting Units
Step 4: Loading the dataset, getting min/max values
Step 5: Creating the animation
/tmp/animator/run.py:91: SyntaxWarning: invalid escape sequence &#39;\d&#39;
  for i in re.findall(&#34;[-\d]+&#34;, unit[n]):
Created animation /tmp/eval_conf/work/runner/freva-ces/output/animator/2129/pr_20160902T0000-20160902T2330.gif in 47 seconds
</pre></div></div>
</div>
<p>This plugin will run in so called interactive mode. That means that it will run on the login node and block your shell until the command is completed. This can be problematic if you have jobs that might take time to finish. An alternative is setting the <code class="docutils literal notranslate"><span class="pre">-–batchmode</span></code> flag. This flag tells the plugin to submit a job to the computing queue. The computing nodes are the core of any high performance computing system. Let’s submit the previous plugin job to the computing queue:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva<span class="w"> </span>plugin<span class="w"> </span>animator<span class="w"> </span><span class="nv">project</span><span class="o">=</span>observations<span class="w"> </span><span class="nv">variable</span><span class="o">=</span>pr<span class="w"> </span><span class="nv">cmap</span><span class="o">=</span>Blues<span class="w"> </span><span class="nv">fps</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="nv">output_unit</span><span class="o">=</span>mm/h<span class="w"> </span><span class="nv">vmin</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="nv">vmax</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="nv">suffix</span><span class="o">=</span>gif<span class="w"> </span>--batchmode
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Scheduled job with history id: 2130
You can view the job&#39;s status with the command squeue
Your job&#39;s progress will be shown with the command
tail -f /tmp/share/slurm/animator/Animator-5031.out
</pre></div></div>
</div>
</section>
<section id="Inspecting-previous-analysis-jobs:-the-freva-history-command">
<h1>Inspecting previous analysis jobs: the freva-history command<a class="headerlink" href="#Inspecting-previous-analysis-jobs:-the-freva-history-command" title="Link to this heading">#</a></h1>
<p>Sometimes it can be useful to access the status of past plugin applications. The <code class="docutils literal notranslate"><span class="pre">freva-history</span></code> command or <code class="docutils literal notranslate"><span class="pre">freva</span> <span class="pre">history</span></code> sub-command can do that:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-history<span class="w"> </span>--limit<span class="w"> </span><span class="m">1</span><span class="w"> </span>--plugin<span class="w"> </span>dummyplugin
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-cyan-fg">[16:04:42]</span><span class="ansi-cyan-fg"> </span><span class="ansi-blue-fg">INFO    </span> freva - INFO - history of <span class="ansi-bold">{</span>plugin<span class="ansi-bold">}</span>, <span class="ansi-yellow-fg">limit</span>=<span class="ansi-cyan-intense-fg ansi-bold">1</span>, <span class="ansi-yellow-fg">since</span>=<span class="ansi-magenta-fg">None</span>,
<span class="ansi-cyan-fg">           </span>         <span class="ansi-yellow-fg">until</span>=<span class="ansi-magenta-fg">None</span>, <span class="ansi-yellow-fg">entry_ids</span>=<span class="ansi-magenta-fg">None</span>
2115) dummyplugin [2025-02-28 15:58:08] finished {&#34;number&#34;: null, &#34;the_number&#34;: 5, &#34;something&#34;: &#34;test&#34;, &#34;other&#34;: 1.4...
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-history<span class="w"> </span>--entry-ids<span class="w"> </span><span class="m">1</span><span class="w"> </span>--full-text
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-cyan-fg">[16:04:44]</span><span class="ansi-cyan-fg"> </span><span class="ansi-blue-fg">INFO    </span> freva - INFO - history, <span class="ansi-yellow-fg">limit</span>=<span class="ansi-cyan-intense-fg ansi-bold">10</span>, <span class="ansi-yellow-fg">since</span>=<span class="ansi-magenta-fg">None</span>, <span class="ansi-yellow-fg">until</span>=<span class="ansi-magenta-fg">None</span>,
<span class="ansi-cyan-fg">           </span>         <span class="ansi-yellow-fg">entry_ids</span>=<span class="ansi-bold">[</span><span class="ansi-green-fg">&#39;1&#39;</span><span class="ansi-bold">]</span>
</pre></div></div>
</div>
<p>To re-run a command of a past configuration you can use the –return-command option to get the command that was used:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-history<span class="w">  </span>--entry-ids<span class="w"> </span><span class="m">136</span><span class="w"> </span>--return-command
</pre></div>
</div>
</div>
</section>
<section id="Managing-your-own-datasets:-the-freva-user-data-command">
<h1>Managing your own datasets: the freva-user-data command<a class="headerlink" href="#Managing-your-own-datasets:-the-freva-user-data-command" title="Link to this heading">#</a></h1>
<p>Freva offers the possibility to share custom datasets with other users by making it searchable via <code class="docutils literal notranslate"><span class="pre">freva-databrowser</span></code>. With help of the <code class="docutils literal notranslate"><span class="pre">freva-user-data</span></code> command users can add their own data to the central data location, (re)-index or delete data in the databrowser.</p>
<p><strong>Note</strong>: Any data that has been added by users will be assigned a special project name: <code class="docutils literal notranslate"><span class="pre">project=user-$USER</span></code>. Let’s inspect the help menu of the freva-user-data or freva user-data command:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-user-data<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
usage: freva-user-data [-h] [-V] {index,add,delete} ...

Update users project data.

positional arguments:
  {index,add,delete}  Available sub-commands:
    index             Index existing user project data to the databrowser.
    add               Add new user project data to the databrowser.
    delete            Delete existing user project data from the databrowser.

options:
  -h, --help          show this help message and exit
  -V, --version       show program&#39;s version number and exit
</pre></div></div>
</div>
<section id="Add-new-data-to-the-databrowser">
<h2>Add new data to the databrowser<a class="headerlink" href="#Add-new-data-to-the-databrowser" title="Link to this heading">#</a></h2>
<p>To be able to add data to the databrowser the file names must follow a strict standard and the files must reside in a specific location. The add sub command takes care about the correct file naming and location. No pre requirements other than the file has to be a valid netCDF or grib file are assumed. In other words this sub command places the user data with the correct naming structure to the correct location.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-user-data<span class="w"> </span>add<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
usage: freva-user-data add [-h] [--how {copy,move,symlink,link}] [--override]
                           [--experiment EXPERIMENT] [--institute INSTITUTE]
                           [--model MODEL] [--variable VARIABLE]
                           [--time-frequency TIME_FREQUENCY]
                           [--ensemble ENSEMBLE] [--cmor-table CMOR_TABLE]
                           [--realm REALM] [--debug]
                           product paths [paths ...]

Add new user project data to the databrowser.

positional arguments:
  product               Product search key the newly added data can be found.
  paths                 Filename(s) or Directories that are going to be added
                        to thedatabrowser.

options:
  -h, --help            show this help message and exit
  --how {copy,move,symlink,link}
                        Method of how the data is added into the central freva
                        user directory. (default: copy)
  --override, --overwrite
                        Replace existing files in the user data structure.
                        (default: False)
  --experiment EXPERIMENT
                        Set the &lt;experiment&gt; information if they can&#39;t be
                        found in the meta data. (default: None)
  --institute INSTITUTE
                        Set the &lt;institute&gt; information if they can&#39;t be found
                        in the meta data. (default: None)
  --model MODEL         Set the &lt;model&gt; information if they can&#39;t be found in
                        the meta data. (default: None)
  --variable VARIABLE   Set the &lt;variable&gt; information if they can&#39;t be found
                        in the meta data. (default: None)
  --time-frequency TIME_FREQUENCY, --time_frequency TIME_FREQUENCY
                        Set the &lt;time_frequency&gt; information if they can&#39;t be
                        found in the meta data. (default: None)
  --ensemble ENSEMBLE   Set the &lt;ensemble&gt; information if they can&#39;t be found
                        in the meta data. (default: None)
  --cmor-table CMOR_TABLE, --cmor_table CMOR_TABLE
                        Set the &lt;cmor-table&gt; information if they can&#39;t be
                        found in the meta data. (default: None)
  --realm REALM         Set the &lt;realm&gt; information if they can&#39;t be found in
                        the metadata. (default: None)
  --debug, -v, -d, --verbose
                        Use verbose output. (default: False)
</pre></div></div>
</div>
<p>Suppose you’ve gotten data from somewhere and want to add this data into the databrowser to make it accessible to others. In this specific example we assume that you have stored your original data in the <code class="docutils literal notranslate"><span class="pre">/tmp/my_awesome_data</span></code> folder. E.g <code class="docutils literal notranslate"><span class="pre">/tmp/my_awesome_data/outfile_0.nc...tmp/my_awesome_data/outfile_9.nc</span></code> The routine will try to gather all necessary metadata from the files. You’ll have to provide additional metadata if mandatory keywords are missing. To make the routine work in this
example we have to provide the institute, model and experiment keywords:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-user-data<span class="w"> </span>add<span class="w"> </span>eur-11b<span class="w"> </span>/tmp/my_awesome_data/outfile_?.nc<span class="w"> </span><span class="se">\</span>
--institute<span class="w"> </span>clex<span class="w"> </span>--model<span class="w"> </span>UM-RA2T<span class="w"> </span>--experiment<span class="w"> </span>Bias-correct
freva-databrowser<span class="w"> </span><span class="nv">experiment</span><span class="o">=</span>bias-correct
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Status: crawling ...ok
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001041800-197001050300.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001040800-197001041700.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001032200-197001040700.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001031200-197001032100.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001030200-197001031100.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001021600-197001030100.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001020600-197001021500.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001012000-197001020500.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001011000-197001011900.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20250228/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001010000-197001010900.nc
</pre></div></div>
</div>
</section>
<section id="Remove-your-data-from-the-databrowser">
<h2>Remove your data from the databrowser<a class="headerlink" href="#Remove-your-data-from-the-databrowser" title="Link to this heading">#</a></h2>
<p>The delete sub command removes entries from the databrowser and if necessary existing files from the central user data location.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-user-data<span class="w"> </span>delete<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
usage: freva-user-data delete [-h] [--delete-from-fs] [--debug]
                              paths [paths ...]

Delete existing user project data from the databrowser.

positional arguments:
  paths                 The user directory(s) that needs to be crawled.

options:
  -h, --help            show this help message and exit
  --delete-from-fs, --delete_from_fs, --delete
                        Do not only delete the files from the databrowser but
                        also from file system. (default: False)
  --debug, -v, -d, --verbose
                        Use verbose output. (default: False)
</pre></div></div>
</div>
<p>Any data in the central user directory that belongs to the user can be deleted from the databrowser and also from the central data location:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-user-data<span class="w"> </span>delete<span class="w"> </span>/tmp/user_data/user-<span class="nv">$USER</span>
freva-databrowser<span class="w"> </span><span class="nv">experiment</span><span class="o">=</span>bias-correct
</pre></div>
</div>
</div>
</section>
<section id="(Re)-Index-existing-data-to-the-databrowser">
<h2>(Re)-Index existing data to the databrowser<a class="headerlink" href="#(Re)-Index-existing-data-to-the-databrowser" title="Link to this heading">#</a></h2>
<p>The index subcommand can be used to update the databrowser for existing user data. For example, if data has been removed from the databrowser it can be re-added:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-user-data<span class="w"> </span>index<span class="w"> </span>--help
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
usage: freva-user-data index [-h] [--data-type {fs}] [--continue-on-errors]
                             [--debug]
                             [crawl_dir ...]

Index existing user project data to the databrowser.

positional arguments:
  crawl_dir             The user directory(s) that needs to be crawled.
                        (default: None)

options:
  -h, --help            show this help message and exit
  --data-type {fs}, --dtype {fs}
                        The data type of the data. (default: fs)
  --continue-on-errors, --continue, -c
                        Continue indexing on error. (default: False)
  --debug, -v, -d, --verbose
                        Use verbose output. (default: False)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-bash notranslate"><div class="highlight"><pre><span></span>freva-user-data<span class="w"> </span>delete<span class="w"> </span>/tmp/user_data/user-<span class="nv">$USER</span>
freva-databrowser<span class="w"> </span><span class="nv">experiment</span><span class="o">=</span>bias-correct
<br/></pre></div>
</div>
</div>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="03-Applying_Plugins_and_Search_for_History.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Applying data analysis Plugins</p>
      </div>
    </a>
    <a class="right-next"
       href="../FAQ.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Frequently Ask Questions and best practices</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">The Freva command line interface</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Searching-for-data:-the-freva-databrowser-command">Searching for data: the freva-databrowser command</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Running-data-analysis-plugins:-the-freva-plugin-command">Running data analysis plugins: the freva-plugin command</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Inspecting-previous-analysis-jobs:-the-freva-history-command">Inspecting previous analysis jobs: the freva-history command</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#Managing-your-own-datasets:-the-freva-user-data-command">Managing your own datasets: the freva-user-data command</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Add-new-data-to-the-databrowser">Add new data to the databrowser</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#Remove-your-data-from-the-databrowser">Remove your data from the databrowser</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#(Re)-Index-existing-data-to-the-databrowser">(Re)-Index existing data to the databrowser</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, DKRZ.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>