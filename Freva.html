
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Freva python module &#8212; freva user guide 2406.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=3ee479438cf8b5e0d341" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/code-tabs.css?v=1bc26e2f" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=3ee479438cf8b5e0d341"></script>

    <script src="_static/documentation_options.js?v=3506fa6d"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/code-tabs.js?v=c983d12e"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Freva';</script>
    <link rel="icon" href="_static/logo.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Freva command line interface" href="FrevaCli.html" />
    <link rel="prev" title="Welcome to Freva’s documentation!" href="index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class=" navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="freva user guide 2406.0.0 documentation - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="freva user guide 2406.0.0 documentation - Home"/>`);</script>
  
  
</a></div>
    
  </div>
  
  <div class=" navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Freva python module
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="FrevaCli.html">
    The Freva command line interface
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="developers_guide.html">
    Plugin Developer Guide
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="notebooks/index.html">
    Examples
  </a>
</li>

            <li class="nav-item dropdown pst-header-nav-item">
                <button class="btn dropdown-toggle nav-item" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-controls="pst-nav-more-links">
                    More
                </button>
                <ul id="pst-nav-more-links" class="dropdown-menu">
                    
<li class="nav-item ">
  <a class="nav-link dropdown-item nav-internal" href="FAQ.html">
    Frequently Ask Questions and best practices
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link dropdown-item nav-internal" href="whats-new.html">
    What’s new
  </a>
</li>

                </ul>
            </li>
            
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/FREVA-CLINT/freva" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <button class="sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav class="navbar-nav">
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item pst-header-nav-item current active">
  <a class="nav-link nav-internal" href="#">
    Freva python module
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="FrevaCli.html">
    The Freva command line interface
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="api/index.html">
    API Reference
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="developers_guide.html">
    Plugin Developer Guide
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="notebooks/index.html">
    Examples
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="FAQ.html">
    Frequently Ask Questions and best practices
  </a>
</li>


<li class="nav-item pst-header-nav-item">
  <a class="nav-link nav-internal" href="whats-new.html">
    What’s new
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/FREVA-CLINT/freva" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"></div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">Freva python module</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="freva-python-module">
<h1>Freva python module<a class="headerlink" href="#freva-python-module" title="Link to this heading">#</a></h1>
<div class="toctree-wrapper compound">
</div>
<p>The following section gives an overview over the usage of the Freva python
module. This section assumes that you know how to get to access to the
python environment that has Freva installed. If this is not the case please
contact one of your Freva admins or the
<a class="reference external" href="FAQ.html">Frequently Asked Questions</a> section for help.</p>
<section id="searching-for-data">
<h2>Searching for data<a class="headerlink" href="#searching-for-data" title="Link to this heading">#</a></h2>
<p>To query data databrowser and search for data you have three different options.
You can the to following methods</p>
<ul class="simple">
<li><p><a class="reference internal" href="#freva.databrowser" title="freva.databrowser"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.databrowser()</span></code></a>: The main method for searching data is the
<a class="reference internal" href="#freva.databrowser" title="freva.databrowser"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.databrowser()</span></code></a> method. The data browser method lets you search
for data <em>files</em> or <em>uris</em> (Uniform Resource Identifier). <em>Uris</em> instead of file
paths are useful because an uri indicates the storage system where the <em>files</em> are
located.</p></li>
<li><p><a class="reference internal" href="#freva.facet_search" title="freva.facet_search"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.facet_search()</span></code></a>: This method lists all search categories (facets) and
their values.</p></li>
<li><p><a class="reference internal" href="#freva.count_values" title="freva.count_values"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.count_values()</span></code></a>: You can count the occurrences of search results with
this method.</p></li>
</ul>
<p>Below you can find a more detailed documentation.</p>
<dl class="py function" id="module-freva">
<dt class="sig sig-object py" id="freva.count_values">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">count_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_select</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'strict'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'flexible'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'file'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'flexible'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiversion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">search_facets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#freva.count_values" title="Link to this definition">#</a></dt>
<dd><p>Count the number of found objects in the databrowser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>str</em><em>, </em><em>default: &quot;&quot;</em>) – Special search facet to refine/subset search results by time.
This can be a string representation of a time range or a single
time step. The time steps have to follow ISO-8601. Valid strings are
<code class="docutils literal notranslate"><span class="pre">%Y-%m-%dT%H:%M</span></code> to <code class="docutils literal notranslate"><span class="pre">%Y-%m-%dT%H:%M</span></code> for time ranges and
<code class="docutils literal notranslate"><span class="pre">%Y-%m-%dT%H:%M</span></code>. <strong>Note</strong>: You don’t have to give the full string
format to subset time steps <code class="docutils literal notranslate"><span class="pre">%Y</span></code>, <code class="docutils literal notranslate"><span class="pre">%Y-%m</span></code> etc are also valid.</p></li>
<li><p><strong>time_select</strong> (<em>str</em><em>, </em><em>default: flexible</em>) – Operator that specifies how the time period is selected. Choose from
flexible (default), strict or file. <code class="docutils literal notranslate"><span class="pre">strict</span></code> returns only those files
that have the <em>entire</em> time period covered. The time search <code class="docutils literal notranslate"><span class="pre">2000</span> <span class="pre">to</span>
<span class="pre">2012</span></code> will not select files containing data from 2010 to 2020 with
the <code class="docutils literal notranslate"><span class="pre">strict</span></code> method. <code class="docutils literal notranslate"><span class="pre">flexible</span></code> will select those files as
<code class="docutils literal notranslate"><span class="pre">flexible</span></code> returns those files that have either start or end period
covered. <code class="docutils literal notranslate"><span class="pre">file</span></code> will only return files where the entire time
period is contained within <em>one single</em> file.</p></li>
<li><p><strong>multiversion</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Select all versions and not just the latest version (default).</p></li>
<li><p><strong>facet</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>default: None</em>) – Count these these facets (attributes &amp; values) instead of the number
of total files. If None (default), the number of total files will
be returned.</p></li>
<li><p><strong>**search_facets</strong> (<em>str</em>) – The facets to be applied in the data search. If not given
the whole dataset will be queried.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of found objects, if the <em>facet</em> key is/are given then the
a dictionary with the number of objects for each search facet/key
is given.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int, dict[str, int]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">num_files</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">count_values</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="s2">&quot;cmorph&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num_files</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>24
</pre></div>
</div>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="nb">print</span><span class="p">(</span><span class="n">freva</span><span class="o">.</span><span class="n">count_values</span><span class="p">(</span><span class="n">facet</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;cmor_table&#39;: {&#39;30min&#39;: 24, &#39;3hr&#39;: 2, &#39;aday&#39;: 10, &#39;amon&#39;: 2, &#39;omon&#39;: 1}, &#39;future&#39;: {}, &#39;grid_label&#39;: {&#39;gn&#39;: 39}, &#39;time_aggregation&#39;: {&#39;mean&#39;: 39}, &#39;variable&#39;: {&#39;hc700&#39;: 1, &#39;pr&#39;: 26, &#39;tas&#39;: 10, &#39;ua&#39;: 2}, &#39;project&#39;: {&#39;cmip6&#39;: 2, &#39;cordex&#39;: 12, &#39;observations&#39;: 24, &#39;reanalysis&#39;: 1}, &#39;ensemble&#39;: {&#39;r1i1p1&#39;: 37, &#39;r1i1p1f1&#39;: 1, &#39;r2i1p1f1&#39;: 1}, &#39;realm&#39;: {&#39;atmos&#39;: 38, &#39;ocean&#39;: 1}, &#39;time_frequency&#39;: {&#39;1day&#39;: 10, &#39;30min&#39;: 24, &#39;3hr&#39;: 2, &#39;mon&#39;: 3}, &#39;experiment&#39;: {&#39;amip&#39;: 2, &#39;cmorph&#39;: 24, &#39;historical&#39;: 10, &#39;oc5&#39;: 1, &#39;rcp85&#39;: 2}, &#39;future_id&#39;: {}, &#39;product&#39;: {&#39;cmip&#39;: 2, &#39;eur-11&#39;: 12, &#39;grid&#39;: 24, &#39;reanalysis&#39;: 1}, &#39;institute&#39;: {&#39;clmcom&#39;: 10, &#39;cpc&#39;: 24, &#39;csiro-arccss&#39;: 1, &#39;gerics&#39;: 2, &#39;mpi-m&#39;: 1, &#39;noaa&#39;: 1}, &#39;fs_type&#39;: {&#39;posix&#39;: 39}, &#39;model&#39;: {&#39;access-cm2&#39;: 1, &#39;cpc&#39;: 24, &#39;mpi-esm1-2-lr&#39;: 1, &#39;mpi-m-mpi-esm-lr-clmcom-cclm4-8-17-v1&#39;: 10, &#39;ncc-noresm1-m-gerics-remo2015-v1&#39;: 2, &#39;nodc&#39;: 1}}
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="freva.databrowser">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">databrowser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiversion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uniq_key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'file'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'uri'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'file'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_select</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'flexible'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'strict'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'file'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'flexible'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">search_facets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Iterator</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></span><a class="headerlink" href="#freva.databrowser" title="Link to this definition">#</a></dt>
<dd><p>Find data in the system.</p>
<p>You can either search for files or data facets (variable, model, …)
that are available. The query is of the form key=value. &lt;value&gt; might
use <a href="#id1"><span class="problematic" id="id2">*</span></a>, ? as wildcards or any regular expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>**search_facets</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>, </em><em>in</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em>) – The facets to be applied in the data search. If not given
the whole dataset will be queried.</p></li>
<li><p><strong>time</strong> (<em>str</em>) – Special search facet to refine/subset search results by time.
This can be a string representation of a time range or a single
time step. The time steps have to follow ISO-8601. Valid strings are
<code class="docutils literal notranslate"><span class="pre">%Y-%m-%dT%H:%M</span></code> to <code class="docutils literal notranslate"><span class="pre">%Y-%m-%dT%H:%M</span></code> for time ranges and
<code class="docutils literal notranslate"><span class="pre">%Y-%m-%dT%H:%M</span></code>. <strong>Note</strong>: You don’t have to give the full string
format to subset time steps <code class="docutils literal notranslate"><span class="pre">%Y</span></code>, <code class="docutils literal notranslate"><span class="pre">%Y-%m</span></code> etc are also valid.</p></li>
<li><p><strong>time_select</strong> (<em>str</em><em>, </em><em>default: flexible</em>) – Operator that specifies how the time period is selected. Choose from
flexible (default), strict or file. <code class="docutils literal notranslate"><span class="pre">strict</span></code> returns only those files
that have the <em>entire</em> time period covered. The time search <code class="docutils literal notranslate"><span class="pre">2000</span> <span class="pre">to</span>
<span class="pre">2012</span></code> will not select files containing data from 2010 to 2020 with
the <code class="docutils literal notranslate"><span class="pre">strict</span></code> method. <code class="docutils literal notranslate"><span class="pre">flexible</span></code> will select those files as
<code class="docutils literal notranslate"><span class="pre">flexible</span></code> returns those files that have either start or end period
covered. <code class="docutils literal notranslate"><span class="pre">file</span></code> will only return files where the entire time
period is contained within <em>one single</em> file.</p></li>
<li><p><strong>uniq_key</strong> (<em>str</em><em>, </em><em>default: file</em>) – Chose if the solr search query should return paths to files or
uris, uris will have the file path along with protocol of the storage
system. Uris can be useful if the the search query result should be
used libraries like fsspec.</p></li>
<li><p><strong>multiversion</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Select all versions and not just the latest version (default).</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>default: 5000</em>) – Size of the search query.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>If <code class="docutils literal notranslate"><span class="pre">all_facets</span></code> is False and <code class="docutils literal notranslate"><span class="pre">facet</span></code> is None an
iterator with results.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterator</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Search for files in the system:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">databrowser</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;obs*&#39;</span><span class="p">,</span> <span class="n">institute</span><span class="o">=</span><span class="s1">&#39;cpc&#39;</span><span class="p">,</span>
                          <span class="n">time_frequency</span><span class="o">=</span><span class="s1">&#39;??min&#39;</span><span class="p">,</span>
                          <span class="n">variable</span><span class="o">=</span><span class="s1">&#39;pr&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">files</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">files</span><span class="p">))</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">break</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;generator object SolrFindFiles._search at 0x7fb3e55478b0&gt;
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022300-201609022330.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022200-201609022230.nc
</pre></div>
</div>
<p>Search for files between a two given time steps:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">file_range</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">databrowser</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s2">&quot;obs*&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="s2">&quot;2016-09-02T22:15 to 2016-10&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_range</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022300-201609022330.nc
/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022200-201609022230.nc
</pre></div>
</div>
<p>The default method for selecting time periods is <code class="docutils literal notranslate"><span class="pre">flexible</span></code>, which means
all files are selected that cover at least start or end date. The
<code class="docutils literal notranslate"><span class="pre">strict</span></code> method implies that the <em>entire</em> search time period has to be
covered by the files. Using the <code class="docutils literal notranslate"><span class="pre">strict</span></code> method in the example above would
only yield one file because the first file contains time steps prior to the
start of the time period:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">file_range</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">databrowser</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s2">&quot;obs*&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="s2">&quot;2016-09-02T22:15 to 2016-10&quot;</span><span class="p">,</span> <span class="n">time_select</span><span class="o">=</span><span class="s2">&quot;strict&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">file_range</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/freva/freva/.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609022300-201609022330.nc
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="freva.facet_search">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">facet_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_select</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'strict'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'flexible'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'file'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'flexible'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiversion</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">facet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">search_facets</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#freva.facet_search" title="Link to this definition">#</a></dt>
<dd><p>Search for data attributes (facets) in the databrowser.</p>
<p>The method queries the databrowser for available search facets (keys)
like model, experiment etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>str</em>) – Special search facet to refine/subset search results by time.
This can be a string representation of a time range or a single
time step. The time steps have to follow ISO-8601. Valid strings are
<code class="docutils literal notranslate"><span class="pre">%Y-%m-%dT%H:%M</span></code> to <code class="docutils literal notranslate"><span class="pre">%Y-%m-%dT%H:%M</span></code> for time ranges and
<code class="docutils literal notranslate"><span class="pre">%Y-%m-%dT%H:%M</span></code>. <strong>Note</strong>: You don’t have to give the full string
format to subset time steps <code class="docutils literal notranslate"><span class="pre">%Y</span></code>, <code class="docutils literal notranslate"><span class="pre">%Y-%m</span></code> etc are also valid.</p></li>
<li><p><strong>time_select</strong> (<em>str</em><em>, </em><em>default: flexible</em>) – Operator that specifies how the time period is selected. Choose from
flexible (default), strict or file. <code class="docutils literal notranslate"><span class="pre">strict</span></code> returns only those files
that have the <em>entire</em> time period covered. The time search <code class="docutils literal notranslate"><span class="pre">2000</span> <span class="pre">to</span>
<span class="pre">2012</span></code> will not select files containing data from 2010 to 2020 with
the <code class="docutils literal notranslate"><span class="pre">strict</span></code> method. <code class="docutils literal notranslate"><span class="pre">flexible</span></code> will select those files as
<code class="docutils literal notranslate"><span class="pre">flexible</span></code> returns those files that have either start or end period
covered. <code class="docutils literal notranslate"><span class="pre">file</span></code> will only return files where the entire time
period is contained within <em>one single</em> file.</p></li>
<li><p><strong>facet</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>default: None</em>) – Retrieve information about these facets (attributes &amp; values).
If None given (default), information about all available facets is
returned.</p></li>
<li><p><strong>multiversion</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Select all versions and not just the latest version (default).</p></li>
<li><p><strong>**search_facets</strong> (<em>str</em>) – The facets to be applied in the data search. If not given
the whole dataset will be queried.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary with a list search facet values for each search facet key.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict[str, list[str]]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">all_facets</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">facet_search</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;obs*&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_facets</span><span class="p">)</span>
<span class="n">spec_facets</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">facet_search</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s1">&#39;obs*&#39;</span><span class="p">,</span>
                                 <span class="n">facet</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;time_frequency&quot;</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spec_facets</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;cmor_table&#39;: [&#39;30min&#39;], &#39;future&#39;: [], &#39;grid_label&#39;: [&#39;gn&#39;], &#39;time_aggregation&#39;: [&#39;mean&#39;], &#39;variable&#39;: [&#39;pr&#39;], &#39;project&#39;: [&#39;observations&#39;], &#39;ensemble&#39;: [&#39;r1i1p1&#39;], &#39;realm&#39;: [&#39;atmos&#39;], &#39;time_frequency&#39;: [&#39;30min&#39;], &#39;experiment&#39;: [&#39;cmorph&#39;], &#39;future_id&#39;: [], &#39;product&#39;: [&#39;grid&#39;], &#39;institute&#39;: [&#39;cpc&#39;], &#39;fs_type&#39;: [&#39;posix&#39;], &#39;model&#39;: [&#39;cpc&#39;]}
{&#39;time_frequency&#39;: [&#39;30min&#39;], &#39;variable&#39;: [&#39;pr&#39;]}
</pre></div>
</div>
<p>Get all models that have a given time step:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">model</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">freva</span><span class="o">.</span><span class="n">facet_search</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s2">&quot;obs*&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="s2">&quot;2016-09-02T22:10&quot;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;cmor_table&#39;, &#39;future&#39;, &#39;grid_label&#39;, &#39;time_aggregation&#39;, &#39;variable&#39;, &#39;project&#39;, &#39;ensemble&#39;, &#39;realm&#39;, &#39;time_frequency&#39;, &#39;experiment&#39;, &#39;future_id&#39;, &#39;product&#39;, &#39;institute&#39;, &#39;fs_type&#39;, &#39;model&#39;]
</pre></div>
</div>
<p>Reverse search: retrieving meta data from a known file.</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">freva</span>
<span class="n">file</span> <span class="o">=</span> <span class="s2">&quot;../.docker/data/observations/grid/CPC/CPC/cmorph/30min/atmos/30min/r1i1p1/v20210618/pr/pr_30min_CPC_cmorph_r1i1p1_201609020000-201609020030.nc&quot;</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">facet_search</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">file</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;cmor_table&#39;: [&#39;30min&#39;], &#39;future&#39;: [], &#39;grid_label&#39;: [&#39;gn&#39;], &#39;time_aggregation&#39;: [&#39;mean&#39;], &#39;variable&#39;: [&#39;pr&#39;], &#39;project&#39;: [&#39;observations&#39;], &#39;ensemble&#39;: [&#39;r1i1p1&#39;], &#39;realm&#39;: [&#39;atmos&#39;], &#39;time_frequency&#39;: [&#39;30min&#39;], &#39;experiment&#39;: [&#39;cmorph&#39;], &#39;future_id&#39;: [], &#39;product&#39;: [&#39;grid&#39;], &#39;institute&#39;: [&#39;cpc&#39;], &#39;fs_type&#39;: [&#39;posix&#39;], &#39;model&#39;: [&#39;cpc&#39;]}
</pre></div>
</div>
</dd></dl>

</section>
<section id="running-analysis-plugins">
<span id="databrowser"></span><h2>Running analysis plugins<a class="headerlink" href="#running-analysis-plugins" title="Link to this heading">#</a></h2>
<p id="plugin">Already defined data analysis tools can be started with the <a class="reference internal" href="#freva.run_plugin" title="freva.run_plugin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.run_plugin()</span></code></a>
method. Besides the <a class="reference internal" href="#freva.run_plugin" title="freva.run_plugin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.run_plugin()</span></code></a> method three more utility methods
(<a class="reference internal" href="#freva.list_plugins" title="freva.list_plugins"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.list_plugins()</span></code></a>, <a class="reference internal" href="#freva.get_tools_list" title="freva.get_tools_list"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.get_tools_list()</span></code></a>,
<a class="reference internal" href="#freva.plugin_doc" title="freva.plugin_doc"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.plugin_doc()</span></code></a>) are available to get an overview over
existing plugins and the documentation of each plugins.</p>
<dl class="py function" id="module-0">
<dt class="sig sig-object py" id="freva.get_tools_list">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">get_tools_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">HelpStr</span></span></span><a class="headerlink" href="#freva.get_tools_list" title="Link to this definition">#</a></dt>
<dd><p>Get a list of plugins with their short description.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>String representation of all available plugins.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="kn">import</span> <span class="nn">rich</span>
<span class="n">rich</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">freva</span><span class="o">.</span><span class="n">get_tools_list</span><span class="p">())</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>┏━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Tool               ┃ Description                          ┃
┡━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Animator           │ Animate data on lon/lat grids        │
│ DummyPlugin        │ A dummy plugin                       │
│ DummyPluginFolders │ A dummy plugin with outputdir folder │
└────────────────────┴──────────────────────────────────────┘
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="freva.list_plugins">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">list_plugins</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#freva.list_plugins" title="Link to this definition">#</a></dt>
<dd><p>Get the plugins that are available on the system.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>List of available Freva plugins.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>list[str]</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="kn">import</span> <span class="nn">rich</span>
<span class="n">rich</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">freva</span><span class="o">.</span><span class="n">list_plugins</span><span class="p">())</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;dummyplugin&#39;, &#39;dummypluginfolders&#39;, &#39;animator&#39;]
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="freva.plugin_doc">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">plugin_doc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tool_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">HelpStr</span></span></span><a class="headerlink" href="#freva.plugin_doc" title="Link to this definition">#</a></dt>
<dd><p>Display the documentation of a given plugin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tool_name</strong> – The name of the tool that should be documented.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>plugin help string.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>PluginNotFoundError:</strong> – if the plugin name does not exist.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="kn">import</span> <span class="nn">rich</span>
<span class="n">rich</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="n">freva</span><span class="o">.</span><span class="n">plugin_doc</span><span class="p">(</span><span class="s2">&quot;animator&quot;</span><span class="p">))</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Animator (v2022.7.15): Create animations (in gif or mp4 format) This tool       
creates plots of solr facets and an animation.                                  
┏━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Option                  ┃ Description                                        ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ input_file              │ NetCDF input file(s), you can choose multiple      │
│                         │ files separated by a , or use a global pattern for │
│                         │ multiple files chose this option only if you don&#39;t │
│                         │ want Freva to find files by seach facets (default: │
│                         │ &lt;null&gt;)                                            │
│ variable                │ Variable name (only applicable if you didn&#39;t       │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ project                 │ Project name (only applicable if you didn&#39;t choose │
│                         │ an input file) (default: &lt;null&gt;)                   │
│ product                 │ Product name (only applicable if you didn&#39;t choose │
│                         │ an input file) (default: &lt;null&gt;)                   │
│ experiment              │ Experiment name (only applicable if you didn&#39;t     │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ institute               │ Institute name (only applicable if you didn&#39;t      │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ model                   │ Model name (only applicable if you didn&#39;t choose   │
│                         │ an input file) (default: &lt;null&gt;)                   │
│ time_frequency          │ Time frequency name (only applicable if you didn&#39;t │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ ensemble                │ Ensemble name (only applicable if you didn&#39;t       │
│                         │ choose an input file) (default: &lt;null&gt;)            │
│ start                   │ Define the first time step to be plotted, leave    │
│                         │ blank if taken from data (default: &lt;null&gt;)         │
│ end                     │ Define the last time step to be plotted, leave     │
│                         │ blank if taken from data (default: &lt;null&gt;)         │
│ time_mean               │ Select a time interval if time                     │
│                         │ averaging/min/max/sum should be applied along the  │
│                         │ time axis. This can be D for daily, M for monthly  │
│                         │ 6H for 6 hours etc. Leave blank if the time axis   │
│                         │ should not be resampled (default) or set to        │
│                         │ &lt;em&gt;all&lt;/em&gt; if you want to collapse the time      │
│                         │ axis. (default: &lt;null&gt;)                            │
│ time_method             │ If resampling of the time axis is chosen (default: │
│                         │ no) set the method: mean, max or min. &lt;b&gt;Note:&lt;/b&gt; │
│                         │ This has only an effect if the above parameter for │
│                         │ &lt;em&gt;time_mean&lt;/em&gt; is set. (default: mean)         │
│ lonlatbox               │ Set the extend of a rectangular lonlatbox          │
│                         │ (left_lon, right_lat, lower_lat, upper_lat)        │
│                         │ (default: &lt;null&gt;)                                  │
│ output_unit             │ Set the output unit of the variable - leave blank  │
│                         │ for no conversion. This can be useful if the unit  │
│                         │ of the input files should be converted, for        │
│                         │ example for precipitation. Note: Although many     │
│                         │ conversions are supported, by using the `pint`     │
│                         │ conversion library. (default: &lt;null&gt;)              │
│ vmin                    │ Set the minimum plotting range (leave blank to     │
│                         │ calculate from data 1st decile) (default: &lt;null&gt;)  │
│ vmax                    │ Set the maximum plotting range (leave blank to     │
│                         │ calculate the 9th decile) (default: &lt;null&gt;)        │
│ cmap                    │ Set the colormap, more information on colormaps is │
│                         │ available on the &lt;a                                │
│                         │ href=&quot;https://matplotlib.org/stable/tutorials/colo │
│                         │ rs/colormaps.html&quot; target=_blank&gt;matplotlib        │
│                         │ website&lt;/a&gt;. (default: RdYlBu_r)                   │
│ linecolor               │ Color of the coast lines in the map (default: k)   │
│ projection              │ Set the global map projection. Note: this should   │
│                         │ the name of the cartopy projection method (e.g     │
│                         │ PlatteCarree for Cylindrical Projection). Pleas    │
│                         │ refer to &lt;a                                        │
│                         │ href=&quot;https://scitools.org.uk/cartopy/docs/latest/ │
│                         │ crs/projections.html&quot;target=_blank&gt;cartopy         │
│                         │ website&lt;/a&gt; for details. (default: PlateCarree)    │
│ proj_centre             │ Set center longitude of the global map projection. │
│                         │ (default: 50)                                      │
│ pic_size                │ Set the size of the picture (in pixel) (default:   │
│                         │ 1360,900)                                          │
│ plot_title              │ Set plot title (default: )                         │
│ cbar_label              │ Overwrite default colorbar label by this value     │
│                         │ (default: )                                        │
│ suffix                  │ Filetype of the animation (default: mp4)           │
│ fps                     │ Set the frames per seceonds of the output          │
│                         │ animation. (default: 5)                            │
│ extra_scheduler_options │ Set additional options for the job submission to   │
│                         │ the workload manager (, separated). Note:          │
│                         │ batchmode and web only. (default: --qos=test,      │
│                         │ --array=20)                                        │
└─────────────────────────┴────────────────────────────────────────────────────┘
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="freva.run_plugin">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">run_plugin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tool_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduled_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unique_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batchmode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">caption</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#freva.PluginStatus" title="freva.utils.PluginStatus"><span class="pre">PluginStatus</span></a></span></span><a class="headerlink" href="#freva.run_plugin" title="Link to this definition">#</a></dt>
<dd><p>Apply an available data analysis plugin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tool_name</strong> – The name of the plugin that is to be applied.</p></li>
<li><p><strong>caption</strong> – Set a caption for the results.</p></li>
<li><p><strong>save</strong> – Save the plugin configuration to default destination.</p></li>
<li><p><strong>save_config</strong> – Save the plugin configuration.</p></li>
<li><p><strong>scheduled_id</strong> – Run a scheduled job from database</p></li>
<li><p><strong>batchmode</strong> – Create a Batch job and submit it to the scheduling system.</p></li>
<li><p><strong>unique_output</strong> – Append a Freva run id to the output/cache folder(s).</p></li>
<li><p><strong>tag</strong> – Use git commit hash to specify a specific version of this tool.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Return code, and the return value of the plugin.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Run a plugin in the foreground.</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">run_plugin</span><span class="p">(</span><span class="s2">&quot;animator&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;pr&quot;</span><span class="p">,</span> <span class="n">project</span><span class="o">=</span><span class="s2">&quot;obs*&quot;</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_result_paths</span><span class="p">(</span><span class="s2">&quot;plot&quot;</span><span class="p">,</span> <span class="s2">&quot;*.*&quot;</span><span class="p">)</span> <span class="c1"># Check the plot output</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>/tmp/animator/run.py:91: SyntaxWarning: invalid escape sequence &#39;\d&#39;
  for i in re.findall(&quot;[-\d]+&quot;, unit[n]):
Setp 1: Collecting all files
Step 2: Opening the netcdf-files, collecting metadata
Step 3: Converting Units
Step 4: Loading the dataset, getting min/max values
Step 5: Creating the animation
/tmp/animator/run.py:91: SyntaxWarning: invalid escape sequence &#39;\d&#39;
  for i in re.findall(&quot;[-\d]+&quot;, unit[n]):
Created animation /tmp/eval_conf/work/runner/freva-ces/output/animator/2117/pr_20160902T0000-20160902T2330.mp4 in 39 seconds
</pre></div>
</div>
<p>Run a plugin in the background. You can interact with the plugin using
the <code class="docutils literal notranslate"><span class="pre">.wait</span></code> method of the :py:class:<code class="docutils literal notranslate"><span class="pre">freva.PluginStatus</span></code> class.</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">run_plugin</span><span class="p">(</span><span class="s2">&quot;animator&quot;</span><span class="p">,</span>
                       <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;pr&quot;</span><span class="p">,</span>
                       <span class="n">project</span><span class="o">=</span><span class="s2">&quot;observations&quot;</span><span class="p">,</span>
                       <span class="n">batchmode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">res</span><span class="o">.</span><span class="n">wait</span><span class="p">()</span> <span class="c1"># Wait until the plugin has finished</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Scheduled job with history id: 2118
You can view the job&#39;s status with the command squeue
Your job&#39;s progress will be shown with the command
tail -f /tmp/share/slurm/animator/Animator-3340.out
☀️  Waiting for plugin to finish... ok
</pre></div>
</div>
</dd></dl>

<p>This specific plugin has created the following output:</p>
<a class="reference internal image-reference" href="_images/animator_output.gif"><img alt="_images/animator_output.gif" src="_images/animator_output.gif" style="width: 400px;" />
</a>
<p>After the application of a data analysis plugin you can check the status of the
plugin and make use of any of the plugin output either by directly using the
return value of the <a class="reference internal" href="#freva.run_plugin" title="freva.run_plugin"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.run_plugin()</span></code></a> method or create an instance
of the <a class="reference internal" href="#freva.PluginStatus" title="freva.PluginStatus"><code class="xref py py-class docutils literal notranslate"><span class="pre">freva.PluginStatus</span></code></a> status class with help of a history id.</p>
<dl class="py class" id="module-1">
<dt class="sig sig-object py" id="freva.PluginStatus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">PluginStatus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">history_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#freva.PluginStatus" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A class to interact with the status of a plugin application.</p>
<p>With help of this class you can:</p>
<blockquote>
<div><ul class="simple">
<li><p>Check if a plugin is still running.</p></li>
<li><p>Get all results (data or plot files) of a plugin.</p></li>
<li><p>Check the configuration of a plugin.</p></li>
<li><p>Wait until the plugin is finished.</p></li>
</ul>
</div></blockquote>
<p class="rubric">Example</p>
<p>The output of the <code class="docutils literal notranslate"><span class="pre">freva.run_plugin</span></code> method is an instance of the
<code class="docutils literal notranslate"><span class="pre">PluginStatus</span></code> class. That means you can directly use the output of
:py:meth:<code class="docutils literal notranslate"><span class="pre">freva.run_plugin</span></code> to interact with the plugin status:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">run_plugin</span><span class="p">(</span><span class="s2">&quot;dummypluginfolders&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Processing output in /tmp/eval_conf/work/runner/freva-ces/output/dummypluginfolders/20240618_164113/2119
finished
</pre></div>
</div>
<p>You can also create an instance of the class yourself, if you know the
<code class="docutils literal notranslate"><span class="pre">history_id</span></code> of a specific plugin run. Note that you can query these ids
by making use of the :py:meth:<code class="docutils literal notranslate"><span class="pre">freva.history</span></code> method:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="c1"># Get the last run of the dummypluginfolders plugin</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">plugin</span><span class="o">=</span><span class="s2">&quot;dummypluginfolders&quot;</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">PluginStatus</span><span class="p">(</span><span class="n">hist</span><span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">status</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[16:41:13] INFO     freva - INFO - history of {plugin}, limit=1,  _history.py:94
                    since=None, until=None, entry_ids=None                      
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="freva.PluginStatus.batch_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batch_id</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#freva.PluginStatus.batch_id" title="Link to this definition">#</a></dt>
<dd><p>Get the id of the batch job, if the plugin was a batchmode job.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="freva.PluginStatus.configuration">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">configuration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#freva.PluginStatus.configuration" title="Link to this definition">#</a></dt>
<dd><p>Get the plugin configuration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="freva.PluginStatus.get_result_paths">
<span class="sig-name descname"><span class="pre">get_result_paths</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'data'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'plot'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'data'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">glob_pattern</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'*.nc'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Path</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#freva.PluginStatus.get_result_paths" title="Link to this definition">#</a></dt>
<dd><p>Get all created paths of a certain data type.</p>
<p>This method allows you to query all output files of the plugin run.
You can either search for data files or plotted output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>str</em>) – The data type of the returned paths. This should be either
data or plot.</p></li>
<li><p><strong>glob_pattern</strong> (str, default: <a href="#id5"><span class="problematic" id="id6">*</span></a>.nc) – Refine the output by filtering the returned files by the given
glob pattern. By default only netCDF files (”<a href="#id3"><span class="problematic" id="id4">*</span></a>.nc”) are added
to the list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>List[Path]</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of paths matching the search constrains.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>We are going to use a plugin called <code class="docutils literal notranslate"><span class="pre">dummypluginfolders</span></code>
which creates plots and netCDF files. In this example we want to
open all netCDF files (<code class="docutils literal notranslate"><span class="pre">dtype</span> <span class="pre">=</span> <span class="pre">'data'</span></code>) that match the filename
constraint <code class="docutils literal notranslate"><span class="pre">*data.nc</span></code>.</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">run_plugin</span><span class="p">(</span><span class="s2">&quot;dummypluginfolders&quot;</span><span class="p">,</span> <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;pr&quot;</span><span class="p">)</span>
<span class="n">dset</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span>
    <span class="n">res</span><span class="o">.</span><span class="n">get_result_paths</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">glob_pattern</span><span class="o">=</span><span class="s2">&quot;*data.nc&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dset</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Processing output in /tmp/eval_conf/work/runner/freva-ces/output/dummypluginfolders/20240618_164113/2120
pr
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="freva.PluginStatus.job_script">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">job_script</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#freva.PluginStatus.job_script" title="Link to this definition">#</a></dt>
<dd><p>Get the content of the job_script, if it was a batchmode job.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="freva.PluginStatus.kill">
<span class="sig-name descname"><span class="pre">kill</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#freva.PluginStatus.kill" title="Link to this definition">#</a></dt>
<dd><p>Kill a running batch job.</p>
<p>This method has only affect on jobs there have been submitted using the
<code class="docutils literal notranslate"><span class="pre">batchmode=True</span></code> flag.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="freva.PluginStatus.plugin">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plugin</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#freva.PluginStatus.plugin" title="Link to this definition">#</a></dt>
<dd><p>Get the plugin name.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="freva.PluginStatus.status">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">status</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#freva.PluginStatus.status" title="Link to this definition">#</a></dt>
<dd><p>Get the state of the current plugin run.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="freva.PluginStatus.stdout">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">stdout</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#freva.PluginStatus.stdout" title="Link to this definition">#</a></dt>
<dd><p>Get the stdout of the plugin.</p>
<p class="rubric">Example</p>
<p>Read the output of the plugin:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">run_plugin</span><span class="p">(</span><span class="s2">&quot;dummypluginfolders&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Processing output in /tmp/eval_conf/work/runner/freva-ces/output/dummypluginfolders/20240618_164113/2121
Processing output in /tmp/eval_conf/work/runner/freva-ces/output/dummypluginfolders/20240618_164113/2121

</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="freva.PluginStatus.version">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">version</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#freva.PluginStatus.version" title="Link to this definition">#</a></dt>
<dd><p>Get the version of the plugin.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="freva.PluginStatus.wait">
<span class="sig-name descname"><span class="pre">wait</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">28800</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#freva.PluginStatus.wait" title="Link to this definition">#</a></dt>
<dd><p>Wait for a plugin to finish.</p>
<p>This method will block until the plugin is running.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>timeout</strong> (<em>int</em><em>, </em><em>default: 28800</em>) – Wait <code class="docutils literal notranslate"><span class="pre">timeout</span></code> seconds for the plugin to finish. If the plugin
hasn’t been finish raise a ValueError.</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the plugin took longer than <code class="docutils literal notranslate"><span class="pre">timeout</span></code> seconds to finish.:</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>This can be useful if a plugin was started using the <code class="docutils literal notranslate"><span class="pre">batchmode=True</span></code>
option and the execution of the code should wait until the plugin is
finished.</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">run_plugin</span><span class="p">(</span><span class="s2">&quot;dummypluginfolders&quot;</span><span class="p">,</span> <span class="n">batchmode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">res</span><span class="o">.</span><span class="n">wait</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span> <span class="c1"># Give the plugin 60 seconds to finish.</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Scheduled job with history id: 2122
You can view the job&#39;s status with the command squeue
Your job&#39;s progress will be shown with the command
tail -f /tmp/share/slurm/dummypluginfolders/DummyPluginFolders-3514.out
☀️  Waiting for plugin to finish... ok
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-2">
<span id="accessing-the-previous-plugin-runs"></span><h2>Accessing the previous plugin runs<a class="headerlink" href="#module-2" title="Link to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="freva.history">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">history</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plugin</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">since</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">until</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">entry_ids</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_text</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_results</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_command</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_return_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#freva.history" title="Link to this definition">#</a></dt>
<dd><p>Get access to the configurations of previously applied freva plugins.</p>
<p>The <cite>.history</cite> method displays the entries with a one-line compact description.
The first number you see is the entry id, which you might use to select
single entries.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>limit</strong> (<em>int</em><em>, </em><em>default: 10</em>) – Limit the number of entries to be displayed.</p></li>
<li><p><strong>plugin</strong> (<em>str</em><em>, </em><em>default: None</em>) – Display only entries from a given plugin name.</p></li>
<li><p><strong>since</strong> (<em>str</em><em>, </em><em>datetime.datetime</em><em>, </em><em>default: None</em>) – Retrieve entries older than date, see hint on date format below.</p></li>
<li><p><strong>until</strong> (<em>str</em><em>, </em><em>datetime.datetime</em><em>, </em><em>default: None</em>) – Retrieve entries younger than date, see hint on date format below.</p></li>
<li><p><strong>entry_ids</strong> (<em>list</em><em>, </em><em>default: None</em>) – Select entries whose ids are in “ids”.</p></li>
<li><p><strong>full_text</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Show the complete configuration.</p></li>
<li><p><strong>return_results</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Also return the plugin results.</p></li>
<li><p><strong>return_command</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Return the commands instead of history objects.</p></li>
<li><p><strong>user_name</strong> (<em>str</em><em>, </em><em>default: None</em>) – Select entries belonging to another user (e.g., user_name=”&lt;username&gt;”)
or all users (all or <a href="#id7"><span class="problematic" id="id8">*</span></a>).</p></li>
<li><p><strong>_return_dict</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Return a dictionary representation, this is only for internal use.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>freva plugin history</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Get the last three history entries:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">hist</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">history</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">hist</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">hist</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">hist</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;configuration&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;list&#39;&gt; 3
dict_keys([&#39;status_dict&#39;, &#39;id&#39;, &#39;timestamp&#39;, &#39;tool&#39;, &#39;version&#39;, &#39;version_details_id&#39;, &#39;configuration&#39;, &#39;slurm_output&#39;, &#39;host&#39;, &#39;uid_id&#39;, &#39;status&#39;, &#39;flag&#39;, &#39;caption&#39;, &#39;result&#39;])
{&#39;variable&#39;: &#39;pr&#39;, &#39;outputdir&#39;: &#39;/tmp/eval_conf/work/runner/freva-ces/output/dummypluginfolders/20240618_164113&#39;}
[16:41:14] INFO     freva - INFO - history, limit=3, since=None,  _history.py:94
                    until=None, entry_ids=None                                  
</pre></div>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Date Format
Dates are given in the ISO-8601 format and can be “YYYY-MM-DDTHH:mm:ss.n”
or any less accurate subset. These are all valid: “2012-02-01T10:08:32.1233431”,
“2012-02-01T10:08:32”, “2012-02-01T10:08”, “2012-02-01T10”, “2012-02-01”,
“2012-02”, “2012”. Missing values are assumed to be the minimal allowed value.
For example: “2012” = “2012-01-01T00:00:00.0”</p>
</div>
</dd></dl>

</section>
<section id="module-3">
<span id="the-userdata-class"></span><h2>The <code class="docutils literal notranslate"><span class="pre">UserData</span></code> class<a class="headerlink" href="#module-3" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="freva.UserData">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">UserData</span></span><a class="headerlink" href="#freva.UserData" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data class that handles user data requests. With help of this class
users can add their own data to the databrowser, (re)-index data in the
databrowser or delete data in the databrowser.</p>
<dl class="py method">
<dt class="sig sig-object py" id="freva.UserData.add">
<span class="sig-name descname"><span class="pre">add</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">product</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'copy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">override</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">defaults</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#freva.UserData.add" title="Link to this definition">#</a></dt>
<dd><p>Add custom user files to the databrowser.</p>
<p>To be able to add data to the databrowser the file names must
follow a strict standard and the files must reside in a
specific location. This <code class="docutils literal notranslate"><span class="pre">add</span></code> method takes care about the correct
file naming and location. No pre requirements other than the file has
to be a valid <code class="docutils literal notranslate"><span class="pre">netCDF</span></code> or <code class="docutils literal notranslate"><span class="pre">grib</span></code> file are assumed. In other words
this method places the user data with the correct naming structure to
the correct location.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>product</strong> (<em>str</em>) – Product search key the newly added data can be found.</p></li>
<li><p><strong>*paths</strong> (<em>os.PathLike</em>) – Filename(s) or Directories that are going to be added to the
databrowser. The files will be added into the central user
directory and named according the CMOR standard. This ensures
that the data can be added into the databrowser.
<strong>Note:</strong> Once the data has been added into the databrowser it can
be found via the <code class="docutils literal notranslate"><span class="pre">user-&lt;username&gt;</span></code> project.</p></li>
<li><p><strong>how</strong> (<em>str</em><em>, </em><em>default: copy</em>) – Method of how the data is added into the central freva user directory.
Default is copy, which means your data files will be replicated.
To avoid a this redundancy you can set the <code class="docutils literal notranslate"><span class="pre">how</span></code> keyword to
<code class="docutils literal notranslate"><span class="pre">symlink</span></code> for symbolic links or <code class="docutils literal notranslate"><span class="pre">link</span></code> for creating hard links
to create symbolic links or <code class="docutils literal notranslate"><span class="pre">move</span></code> to move the data into the central
user directory entirely.</p></li>
<li><p><strong>override</strong> (<em>bool</em><em>, </em><em>default: False</em>) – Replace existing files in the user data structure.</p></li>
<li><p><strong>experiment</strong> (<em>str</em><em>, </em><em>default: None</em>) – By default the method tries to deduce the <em>experiment</em> information from
the metadata. To overwrite this information the <em>experiment</em> keyword
should be set.</p></li>
<li><p><strong>institute</strong> (<em>str</em><em>, </em><em>default: None</em>) – By default the method tries to deduce the <em>institute</em> information from
the metadata. To overwrite this information the <em>institute</em> keyword
should be set.</p></li>
<li><p><strong>model</strong> (<em>str</em><em>, </em><em>default: None</em>) – By default the method tries to deduce the <em>model</em> information from
the metadata. To overwrite this information the <em>model</em> keyword
should be set.</p></li>
<li><p><strong>variable</strong> (<em>str</em><em>, </em><em>default: None</em>) – By default the method tries to deduce the <em>variable</em> information from
the metadata. To overwrite this information the <em>variable</em> keyword
should be set.</p></li>
<li><p><strong>time_frequency</strong> (<em>str</em><em>, </em><em>default: None</em>) – By default the method tries to deduce the <em>time_frequency</em> information
from the metadata. To overwrite this information the <em>time_frequency</em>
keyword should be set.</p></li>
<li><p><strong>ensemble</strong> (<em>str</em><em>, </em><em>default: None</em>) – By default the method tries to deduce the <em>ensemble</em> information from
the metadata. To overwrite this information the <em>ensemble</em> keyword
should be set.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If metadata is insufficient, or product key is empty.:</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Suppose you’ve gotten data from somewhere and want to add this data into the
databrowser to make it accessible to others. In this specific
example we assume that you have stored your <cite>original</cite> data in the
<code class="docutils literal notranslate"><span class="pre">/tmp/my_awesome_data</span></code> folder.
E.g <code class="docutils literal notranslate"><span class="pre">/tmp/my_awesome_data/outfile_0.nc...tmp/my_awesome_data/outfile_9.nc</span></code>
The routine will try to gather all necessary metadata from the files. You’ll
have to provide additional metadata if mandatory keywords are missing.
To make the routine work you’ll have to provide the <code class="docutils literal notranslate"><span class="pre">institute</span></code>, <code class="docutils literal notranslate"><span class="pre">model</span></code>
and <code class="docutils literal notranslate"><span class="pre">experiment</span></code> keywords:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">freva</span> <span class="kn">import</span> <span class="n">UserData</span><span class="p">,</span> <span class="n">databrowser</span>
<span class="n">user_data</span> <span class="o">=</span> <span class="n">UserData</span><span class="p">()</span>
<span class="c1"># You can also provide wild cards to search for data</span>
<span class="n">user_data</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;eur-11b&quot;</span><span class="p">,</span> <span class="s2">&quot;/tmp/my_awesome_data/outfile_?.nc&quot;</span><span class="p">,</span>
                  <span class="n">institute</span><span class="o">=</span><span class="s2">&quot;clex&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="s2">&quot;UM-RA2T&quot;</span><span class="p">,</span>
                  <span class="n">experiment</span><span class="o">=</span><span class="s2">&quot;Bias-correct&quot;</span><span class="p">)</span>
<span class="c1"># Check the databrowser if the data has been added</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">databrowser</span><span class="p">(</span><span class="n">experiment</span><span class="o">=</span><span class="s2">&quot;bias*&quot;</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Status: crawling ...ok
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001041800-197001050300.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001040800-197001041700.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001032200-197001040700.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001031200-197001032100.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001030200-197001031100.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001021600-197001030100.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001020600-197001021500.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001012000-197001020500.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001011000-197001011900.nc
/tmp/user_data/user-runner/eur-11b/clex/UM-RA2T/Bias-correct/hr/user_data/hr/r0i0p0/v20240618/tas/tas_hr_UM-RA2T_Bias-correct_r0i0p0_197001010000-197001010900.nc
</pre></div>
</div>
<p>By default the data is copied. By using the <code class="docutils literal notranslate"><span class="pre">how</span></code> keyword you can
also link or move the data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="freva.UserData.delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delete_from_fs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#freva.UserData.delete" title="Link to this definition">#</a></dt>
<dd><p>Delete data from the databrowser.</p>
<p>The methods deletes user data from the databrowser.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*paths</strong> (<em>os.PathLike</em>) – Filename(s) or Directories that are going to be from  the
databrowser.</p></li>
<li><p><strong>delete_from_fs</strong> (<em>bool</em><em>, </em><em>default : False</em>) – Do not only delete the files from the databrowser but also from their
central location where they have been added to.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValidationError:</strong> – If crawl_dirs do not belong to current user.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Any data in the central user directory that belongs to the user can
be deleted from the databrowser and also from the central data location:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">freva</span> <span class="kn">import</span> <span class="n">UserData</span>
<span class="n">user_data</span> <span class="o">=</span> <span class="n">UserData</span><span class="p">()</span>
<span class="n">user_data</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">user_data</span><span class="o">.</span><span class="n">user_dir</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="freva.UserData.index">
<span class="sig-name descname"><span class="pre">index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">crawl_dirs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">PathLike</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'fs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continue_on_errors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#freva.UserData.index" title="Link to this definition">#</a></dt>
<dd><p>Index and add user output data to the databrowser.</p>
<p>This method can be used to update the databrowser for existing user data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>crawl_dirs</strong> – The data path(s) that needs to be crawled.</p></li>
<li><p><strong>dtype</strong> – The data type, currently only files on the file system are supported.</p></li>
<li><p><strong>continue_on_errors</strong> – Continue indexing on error.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValidationError:</strong> – If crawl_dirs do not belong to current user.</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>If data has been removed from the databrowser it can be re added using
the <code class="docutils literal notranslate"><span class="pre">index</span></code> method:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">freva</span> <span class="kn">import</span> <span class="n">UserData</span>
<span class="n">user_data</span> <span class="o">=</span> <span class="n">UserData</span><span class="p">()</span>
<span class="n">user_data</span><span class="o">.</span><span class="n">index</span><span class="p">()</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Status: crawling ...ok
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="freva.UserData.user_dir">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">user_dir</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Path</span></em><a class="headerlink" href="#freva.UserData.user_dir" title="Link to this definition">#</a></dt>
<dd><p>Get the user data directory for the user.</p>
</dd></dl>

</dd></dl>

</section>
<section id="overriding-or-using-a-freva-configuration">
<h2>Overriding or using a freva configuration<a class="headerlink" href="#overriding-or-using-a-freva-configuration" title="Link to this heading">#</a></h2>
<p>If you want to install and maintain an instance of the freva client in your
own python environment you will most likely have to load the freva configuration
to be able to use the freva infrastructure. To do so you can use the
<a class="reference internal" href="#freva.config" title="freva.config"><code class="xref py py-class docutils literal notranslate"><span class="pre">freva.config</span></code></a> class. This class allows you to either override or
set the path to the freva configuration file.</p>
<dl class="py class" id="module-4">
<dt class="sig sig-object py" id="freva.config">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#freva.config" title="Link to this definition">#</a></dt>
<dd><p>Override the default or set the freva system configuration file.</p>
<p>With the help of this class you can not only (temporarily) override
the default configuration file and use a configuration from another
project, but you can also set a path to a configuration file if no
configuration file has been set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config_file</strong> (<em>str</em><em> | </em><em>pathlib.Path</em>) – Path to the (new) configuration file.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Temporarily override the existing configuration file and use a new one.
You can use a context manager to temporally use a different configuration
and switch back later.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="k">with</span> <span class="n">freva</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;/work/freva/evaluation_system.conf&quot;</span><span class="p">):</span>
    <span class="n">freva</span><span class="o">.</span><span class="n">run_plugin</span><span class="p">(</span><span class="s2">&quot;plugin_from_another_project&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you do not want to switch to another configuration only
temporarily, but want to use it permanently, you can use
<a class="reference internal" href="#freva.config" title="freva.config"><code class="xref py py-class docutils literal notranslate"><span class="pre">freva.config</span></code></a> without a context manager:
a context manager:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">freva</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="s2">&quot;/work/freva/evaluation_system.conf&quot;</span><span class="p">)</span>
<span class="n">files</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">freva</span><span class="o">.</span><span class="n">databrowser</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s2">&quot;user-1234&quot;</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="s2">&quot;extremes&quot;</span><span class="p">))</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="freva.config.db_reloaded">
<span class="sig-name descname"><span class="pre">db_reloaded</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[False]</span></em><a class="headerlink" href="#freva.config.db_reloaded" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

</section>
<section id="searching-for-esgf-data">
<h2>Searching for ESGF data<a class="headerlink" href="#searching-for-esgf-data" title="Link to this heading">#</a></h2>
<p>Freva also allows to query for data in all the ESGF nodes. You have the following 5
methods:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#freva.esgf_browser" title="freva.esgf_browser"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.esgf_browser()</span></code></a>: The main method for searching data. The browser
method lets you search for data URLs (default) or their opendap/gridftp endpoints.</p></li>
<li><p><a class="reference internal" href="#freva.esgf_facets" title="freva.esgf_facets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.esgf_facets()</span></code></a>: This method lists all search categories (facets) and
their values.</p></li>
<li><p><a class="reference internal" href="#freva.esgf_datasets" title="freva.esgf_datasets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.esgf_datasets()</span></code></a>: This method lists the name of the datasets (and version)
in the ESGF.</p></li>
<li><p><a class="reference internal" href="#freva.esgf_download" title="freva.esgf_download"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.esgf_download()</span></code></a>: You can download the data with the script file
that this method creates.</p></li>
<li><p><a class="reference internal" href="#freva.esgf_query" title="freva.esgf_query"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.esgf_query()</span></code></a>: Similarly to <a class="reference internal" href="#freva.esgf_facets" title="freva.esgf_facets"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.esgf_facets()</span></code></a>, this method lists
all query elements but groups them <em>by dataset</em>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The collection of methods
are derived from <a class="reference external" href="https://github.com/ESGF/esgf.github.io/wiki/ESGF_Search_REST_API">ESGF’s rest API</a>.
The query facets follow the syntax of the datasets hosted there (CMIP5, CORDEX, CMIP6, etc.)
that might differ from <a class="reference internal" href="#freva.databrowser" title="freva.databrowser"><code class="xref py py-meth docutils literal notranslate"><span class="pre">freva.databrowser()</span></code></a> and <strong>are</strong> case
sensitive. They also have some special query keys, e.g.:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">distrib</span></code>: (<strong>true</strong>, false) search globally or only locally (e.g. at DKRZ, MPI data and replicas)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latest</span></code> : (true, false, <strong>unset</strong>) search for the latest version, older ones or all.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">replica</span></code>: (true, false, <strong>unset</strong>) search only for replicas, non-replicas, or all.</p></li>
</ul>
</div>
<p>Below you can find a more detailed documentation.</p>
<dl class="py function" id="module-5">
<dt class="sig sig-object py" id="freva.esgf_browser">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">esgf_browser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">opendap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gridftp</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">search_constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#freva.esgf_browser" title="Link to this definition">#</a></dt>
<dd><p>Find data in the ESGF.</p>
<p>The method queries the ESGF nodes for file URLs (default) or
opendap/gridftp endpoints as well.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">key=value</span></code> syntax follows that of <code class="docutils literal notranslate"><span class="pre">freva.databrowser</span></code>
but the key names follow the ESGF standards for each dataset.
Search of multiple values for the same key can be achieved
either as a <code class="docutils literal notranslate"><span class="pre">str</span></code> concatenation (e.g.``frequency=”3hr,mon” ``
with <strong>no</strong> space between variables) or as a <code class="docutils literal notranslate"><span class="pre">list</span></code>
(e.g. <code class="docutils literal notranslate"><span class="pre">frequency=[&quot;3hr&quot;,</span> <span class="pre">&quot;mon&quot;]</span></code>).</p>
<section id="parameters">
<h3>Parameters:<a class="headerlink" href="#parameters" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>opendap: bool, default: False</dt><dd><p>List opendap endpoints instead of http ones.</p>
</dd>
<dt>gridftp: bool, default: False</dt><dd><p>Show gridftp endpoints instead of the http default
ones (or skip them if none found)</p>
</dd>
<dt><a href="#id9"><span class="problematic" id="id10">**</span></a>search_constraints: Union[str, Path, in, list[str]]</dt><dd><p>Search facets to be applied in the data search.</p>
</dd>
</dl>
</section>
<section id="returns">
<h3>Returns:<a class="headerlink" href="#returns" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>list :</dt><dd><p>Collection of files</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Similarly to <code class="docutils literal notranslate"><span class="pre">freva.databrowser</span></code>, <code class="docutils literal notranslate"><span class="pre">freva.esgf_browser</span></code>
expects a list of <code class="docutils literal notranslate"><span class="pre">key=value</span></code> pairs in no particular
order, but unlike the former it <em>is</em> case sensitive.</p>
<p>Given that your Freva instance is configured at DKRZ,
if we want to search the URLs of all the files stored
at the (DKRZ) local node (<code class="docutils literal notranslate"><span class="pre">distrib=false</span></code>) holding
the latest version (<code class="docutils literal notranslate"><span class="pre">latest=true</span></code>) of the variable
uas (<code class="docutils literal notranslate"><span class="pre">variable=uas</span></code>) for either 3hr or monthly
time frequencies ( <code class="docutils literal notranslate"><span class="pre">frequency=[&quot;3hr&quot;,</span> <span class="pre">&quot;mon&quot;]</span></code>)
and for a particular realization within the
project <code class="docutils literal notranslate"><span class="pre">CMIP6</span></code>:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">esgf_browser</span><span class="p">(</span>
    <span class="n">mip_era</span><span class="o">=</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">,</span>
    <span class="n">activity_id</span><span class="o">=</span><span class="s2">&quot;ScenarioMIP&quot;</span><span class="p">,</span>
    <span class="n">source_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CM6-1&quot;</span><span class="p">,</span>
    <span class="n">institution_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CERFACS&quot;</span><span class="p">,</span>
    <span class="n">experiment_id</span><span class="o">=</span><span class="s2">&quot;ssp585&quot;</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;3hr,mon&quot;</span><span class="p">,</span>
    <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;uas&quot;</span><span class="p">,</span>
    <span class="n">variant_label</span><span class="o">=</span><span class="s2">&quot;r1i1p1f2&quot;</span><span class="p">,</span>
    <span class="n">distrib</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">latest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">files</span><span class="p">)</span><span class="w"> </span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">files</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>len(files) =10
http://esgf3.dkrz.de/thredds/fileServer/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/Amon/uas/gr/v20190219/uas_Amon_CNRM-CM6-1_ssp585_r1i1p1f2_gr_201501-210012.nc
http://esgf3.dkrz.de/thredds/fileServer/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_201501010130-202412312230.nc
http://esgf3.dkrz.de/thredds/fileServer/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_202501010130-203412312230.nc
http://esgf3.dkrz.de/thredds/fileServer/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_203501010130-204412312230.nc
http://esgf3.dkrz.de/thredds/fileServer/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_204501010130-205412312230.nc
</pre></div>
</div>
<p>In order to list the opendap endpoints (<code class="docutils literal notranslate"><span class="pre">opendap=True</span></code>):</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">opendap</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">esgf_browser</span><span class="p">(</span>
    <span class="n">mip_era</span><span class="o">=</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">,</span>
    <span class="n">activity_id</span><span class="o">=</span><span class="s2">&quot;ScenarioMIP&quot;</span><span class="p">,</span>
    <span class="n">source_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CM6-1&quot;</span><span class="p">,</span>
    <span class="n">institution_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CERFACS&quot;</span><span class="p">,</span>
    <span class="n">experiment_id</span><span class="o">=</span><span class="s2">&quot;ssp585&quot;</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;3hr&quot;</span><span class="p">,</span>
    <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;uas&quot;</span><span class="p">,</span>
    <span class="n">variant_label</span><span class="o">=</span><span class="s2">&quot;r1i1p1f2&quot;</span><span class="p">,</span>
    <span class="n">distrib</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">latest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">opendap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">opendap</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;http://esgf3.dkrz.de/thredds/dodsC/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_201501010130-202412312230.nc.html&#39;, &#39;http://esgf3.dkrz.de/thredds/dodsC/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_202501010130-203412312230.nc.html&#39;, &#39;http://esgf3.dkrz.de/thredds/dodsC/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_203501010130-204412312230.nc.html&#39;, &#39;http://esgf3.dkrz.de/thredds/dodsC/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_204501010130-205412312230.nc.html&#39;, &#39;http://esgf3.dkrz.de/thredds/dodsC/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_205501010130-206412312230.nc.html&#39;, &#39;http://esgf3.dkrz.de/thredds/dodsC/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_206501010130-207412312230.nc.html&#39;, &#39;http://esgf3.dkrz.de/thredds/dodsC/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_207501010130-208412312230.nc.html&#39;, &#39;http://esgf3.dkrz.de/thredds/dodsC/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_208501010130-209412312230.nc.html&#39;, &#39;http://esgf3.dkrz.de/thredds/dodsC/cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_209501010130-210012312230.nc.html&#39;]
</pre></div>
</div>
<p>Or the gridftp endpoints instead (<code class="docutils literal notranslate"><span class="pre">gridftp=True</span></code>):</p>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[&#39;gsiftp://esgf3.dkrz.de:2811//cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_201501010130-202412312230.nc&#39;, &#39;gsiftp://esgf3.dkrz.de:2811//cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_202501010130-203412312230.nc&#39;, &#39;gsiftp://esgf3.dkrz.de:2811//cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_203501010130-204412312230.nc&#39;, &#39;gsiftp://esgf3.dkrz.de:2811//cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_204501010130-205412312230.nc&#39;, &#39;gsiftp://esgf3.dkrz.de:2811//cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_205501010130-206412312230.nc&#39;, &#39;gsiftp://esgf3.dkrz.de:2811//cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_206501010130-207412312230.nc&#39;, &#39;gsiftp://esgf3.dkrz.de:2811//cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_207501010130-208412312230.nc&#39;, &#39;gsiftp://esgf3.dkrz.de:2811//cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_208501010130-209412312230.nc&#39;, &#39;gsiftp://esgf3.dkrz.de:2811//cmip6/ScenarioMIP/CNRM-CERFACS/CNRM-CM6-1/ssp585/r1i1p1f2/E3hr/uas/gr/v20190219/uas_E3hr_CNRM-CM6-1_ssp585_r1i1p1f2_gr_209501010130-210012312230.nc&#39;]
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="freva.esgf_datasets">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">esgf_datasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">search_constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#freva.esgf_datasets" title="Link to this definition">#</a></dt>
<dd><p>List the name of the datasets (and version) in the ESGF.</p>
<p>The method queries the ESGF nodes for dataset information.
The <code class="docutils literal notranslate"><span class="pre">key=value</span></code> syntax follows that of <code class="docutils literal notranslate"><span class="pre">freva.databrowser</span></code>
but the key names follow the ESGF standards for each dataset.</p>
<section id="id11">
<h3>Parameters:<a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt><a href="#id12"><span class="problematic" id="id13">**</span></a>search_constraints: Union[str, Path, in, list[str]]</dt><dd><p>Search facets to be applied in the data search.</p>
</dd>
</dl>
</section>
<section id="id14">
<h3>Returns:<a class="headerlink" href="#id14" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>list[tuple[str, str]]:</dt><dd><p>list of (dataset_name, version_number) tuples</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>List the datasets corresponding to a query of files
stored at the (DKRZ) local node (<code class="docutils literal notranslate"><span class="pre">distrib=false</span></code>)
holding the latest version (<code class="docutils literal notranslate"><span class="pre">latest=true</span></code>) for a particular
realization within the project <code class="docutils literal notranslate"><span class="pre">CMIP6</span></code>:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">datasets</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">esgf_datasets</span><span class="p">(</span>
    <span class="n">mip_era</span><span class="o">=</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">,</span>
    <span class="n">activity_id</span><span class="o">=</span><span class="s2">&quot;ScenarioMIP&quot;</span><span class="p">,</span>
    <span class="n">source_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CM6-1&quot;</span><span class="p">,</span>
    <span class="n">institution_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CERFACS&quot;</span><span class="p">,</span>
    <span class="n">experiment_id</span><span class="o">=</span><span class="s2">&quot;ssp585&quot;</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;3hr&quot;</span><span class="p">,</span>
    <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;uas&quot;</span><span class="p">,</span>
    <span class="n">variant_label</span><span class="o">=</span><span class="s2">&quot;r1i1p1f2&quot;</span><span class="p">,</span>
    <span class="n">distrib</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">latest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">datasets</span><span class="p">)</span><span class="w"> </span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">dataset</span> <span class="ow">in</span> <span class="n">datasets</span><span class="p">[:</span><span class="mi">5</span><span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">dataset</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>len(datasets) =1
(&#39;CMIP6.ScenarioMIP.CNRM-CERFACS.CNRM-CM6-1.ssp585.r1i1p1f2.E3hr.uas.gr&#39;, 20190219)
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="freva.esgf_download">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">esgf_download</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">download_script</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">search_constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Path</span></span></span><a class="headerlink" href="#freva.esgf_download" title="Link to this definition">#</a></dt>
<dd><p>Create a script file to download the queried files at ESGF.</p>
<p>The method creates a bash script wrapper of a wget query
from ESGF dataset(s) (only http).</p>
<section id="id15">
<h3>Parameters:<a class="headerlink" href="#id15" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>download_script: Union[str, Path], default: None</dt><dd><p>Download wget_script for getting the files
instead of displaying anything (only http)</p>
</dd>
<dt><a href="#id16"><span class="problematic" id="id17">**</span></a>search_constraints: Union[str, Path, in, list[str]]</dt><dd><p>Search facets to be applied in the data search.</p>
</dd>
</dl>
</section>
<section id="id18">
<h3>Returns:<a class="headerlink" href="#id18" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>Union[str, Path]:</dt><dd><p>wget_script to download the files (only http).</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Create a wget script to download the queried URLs:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">freva</span><span class="o">.</span><span class="n">esgf_download</span><span class="p">(</span><span class="n">project</span><span class="o">=</span><span class="s2">&quot;CMIP5&quot;</span><span class="p">,</span>
            <span class="n">experiment</span><span class="o">=</span><span class="s2">&quot;decadal1960&quot;</span><span class="p">,</span>
            <span class="n">variable</span><span class="o">=</span><span class="s2">&quot;tas&quot;</span><span class="p">,</span> <span class="n">distrib</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">latest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">download_script</span><span class="o">=</span><span class="s2">&quot;/tmp/script.get&quot;</span><span class="p">)</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;/tmp/script.get&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">content</span><span class="p">[:</span><span class="mi">10</span><span class="p">]))</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
 ##############################################################################
 # ESG Federation download script
 #
 # Template version: 1.2
 # Generated by esgf-data.dkrz.de - 2024/06/18 18:41:20
 # Search URL: http://esgf-data.dkrz.de/esg-search/wget?project=CMIP5&amp;experiment=decadal1960&amp;variable=tas&amp;distrib=False&amp;latest=True&amp;type=File
 #
 ###############################################################################
 # first be sure it&#39;s bash... anything out of bash or sh will break

</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You will need an OpenID account to download the data,
for example <a class="reference external" href="https://esgf-data.dkrz.de/user/add/?next=http://esgf-data.dkrz.de/projects/esgf-dkrz/">here</a>.</p>
<p>There is a <a class="reference external" href="https://esgf-pyclient.readthedocs.io/en/latest/index.html">ESGF PyClient</a> as well.</p>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="freva.esgf_facets">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">esgf_facets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show_facet</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">search_constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#freva.esgf_facets" title="Link to this definition">#</a></dt>
<dd><p>Search for data attributes (facets) through ESGF.</p>
<p>The method queries the ESGF nodes for available search facets (keys)
like model, experiment etc. The <code class="docutils literal notranslate"><span class="pre">key=value</span></code> syntax follows that of
<code class="docutils literal notranslate"><span class="pre">freva.facet_search</span></code> but the key names follow the ESGF standards
for each dataset.</p>
<section id="id19">
<h3>Parameters:<a class="headerlink" href="#id19" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>show_facet: Union[str, list[str]], default: None</dt><dd><p>List all values for the given facet (might be
defined multiple times). The results show the possible
values of the selected facet according to the given
constraints and the number of <em>datasets</em> (not files)
that selecting such value as a constraint will result
(faceted search)</p>
</dd>
<dt><a href="#id20"><span class="problematic" id="id21">**</span></a>search_constraints: Union[str, Path, in, list[str]]</dt><dd><p>Search facets to be applied in the data search.</p>
</dd>
</dl>
</section>
<section id="id22">
<h3>Returns:<a class="headerlink" href="#id22" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>dict[str, list[str]]:</dt><dd><p>Collection of facets</p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>List the values of the attributes <code class="docutils literal notranslate"><span class="pre">variable</span></code>
and <code class="docutils literal notranslate"><span class="pre">time_frequency</span></code> stored at the (DKRZ) local node
(<code class="docutils literal notranslate"><span class="pre">distrib=false</span></code>) holding the latest version (<code class="docutils literal notranslate"><span class="pre">latest=true</span></code>)
for a particular realization within the project <code class="docutils literal notranslate"><span class="pre">CMIP6</span></code>:</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">freva</span>
<span class="n">facets</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">esgf_facets</span><span class="p">(</span>
    <span class="n">mip_era</span><span class="o">=</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">,</span>
    <span class="n">activity_id</span><span class="o">=</span><span class="s2">&quot;ScenarioMIP&quot;</span><span class="p">,</span>
    <span class="n">source_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CM6-1&quot;</span><span class="p">,</span>
    <span class="n">institution_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CERFACS&quot;</span><span class="p">,</span>
    <span class="n">experiment_id</span><span class="o">=</span><span class="s2">&quot;ssp585&quot;</span><span class="p">,</span>
    <span class="n">distrib</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">latest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_facet</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;variable&quot;</span><span class="p">,</span> <span class="s2">&quot;frequency&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">facets</span><span class="p">)</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;variable&#39;: {&#39;abs550aer&#39;: 6, &#39;agesno&#39;: 6, &#39;areacello&#39;: 6, &#39;baresoilFrac&#39;: 5, &#39;bigthetao&#39;: 6, &#39;bigthetaoga&#39;: 6, &#39;c3PftFrac&#39;: 1, &#39;c4PftFrac&#39;: 1, &#39;ccb&#39;: 6, &#39;cct&#39;: 6, &#39;ch4global&#39;: 6, &#39;ci&#39;: 6, &#39;cl&#39;: 6, &#39;cli&#39;: 6, &#39;clivi&#39;: 6, &#39;clt&#39;: 12, &#39;clw&#39;: 6, &#39;clwvi&#39;: 6, &#39;co2mass&#39;: 6, &#39;cropFrac&#39;: 6, &#39;cropFracC3&#39;: 6, &#39;cropFracC4&#39;: 6, &#39;evspsbl&#39;: 6, &#39;evspsblpot&#39;: 6, &#39;evspsblsoi&#39;: 6, &#39;evspsblveg&#39;: 6, &#39;ficeberg&#39;: 6, &#39;friver&#39;: 6, &#39;gpp&#39;: 6, &#39;grassFrac&#39;: 6, &#39;grassFracC3&#39;: 5, &#39;grassFracC4&#39;: 6, &#39;hcont300&#39;: 6, &#39;hfbasin&#39;: 6, &#39;hfbasinpmadv&#39;: 6, &#39;hfds&#39;: 6, &#39;hfdsn&#39;: 6, &#39;hfls&#39;: 7, &#39;hfss&#39;: 7, &#39;hfx&#39;: 6, &#39;hfy&#39;: 6, &#39;htovgyre&#39;: 5, &#39;htovovrt&#39;: 6, &#39;hur&#39;: 6, &#39;hurs&#39;: 11, &#39;hursmax&#39;: 6, &#39;hursmin&#39;: 6, &#39;hus&#39;: 13, &#39;hus850&#39;: 1, &#39;huss&#39;: 13, &#39;intuadse&#39;: 6, &#39;intuaw&#39;: 6, &#39;intvadse&#39;: 6, &#39;intvaw&#39;: 6, &#39;lai&#39;: 12, &#39;landCoverFrac&#39;: 1, &#39;lwp&#39;: 1, &#39;lwsnl&#39;: 6, &#39;masscello&#39;: 6, &#39;masso&#39;: 6, &#39;mc&#39;: 6, &#39;mfo&#39;: 6, &#39;mlotst&#39;: 6, &#39;mlotstmax&#39;: 6, &#39;mlotstmin&#39;: 6, &#39;mrfso&#39;: 6, &#39;mrlso&#39;: 6, &#39;mrro&#39;: 6, &#39;mrros&#39;: 6, &#39;mrsfl&#39;: 12, &#39;mrsll&#39;: 10, &#39;mrso&#39;: 12, &#39;mrsol&#39;: 12, &#39;mrsos&#39;: 6, &#39;mrtws&#39;: 6, &#39;msftyz&#39;: 6, &#39;n2oglobal&#39;: 6, &#39;npp&#39;: 6, &#39;nwdFracLut&#39;: 6, &#39;o3&#39;: 6, &#39;od550aer&#39;: 6, &#39;od550dust&#39;: 1, &#39;od550so4&#39;: 1, &#39;pbo&#39;: 6, &#39;pr&#39;: 8, &#39;prc&#39;: 12, &#39;prrc&#39;: 1, &#39;prsn&#39;: 11, &#39;prveg&#39;: 6, &#39;prw&#39;: 7, &#39;ps&#39;: 7, &#39;psl&#39;: 12, &#39;ptp&#39;: 6, &#39;ra&#39;: 6, &#39;residualFrac&#39;: 6, &#39;rivo&#39;: 6, &#39;rlds&#39;: 13, &#39;rldscs&#39;: 6, &#39;rls&#39;: 1, &#39;rlus&#39;: 12, &#39;rlut&#39;: 11, &#39;rlutaf&#39;: 6, &#39;rlutcs&#39;: 6, &#39;rlutcsaf&#39;: 6, &#39;rsds&#39;: 13, &#39;rsdscs&#39;: 6, &#39;rsdt&#39;: 6, &#39;rsntds&#39;: 6, &#39;rss&#39;: 1, &#39;rsus&#39;: 6, &#39;rsuscs&#39;: 5, &#39;rsut&#39;: 6, &#39;rsutaf&#39;: 6, &#39;rsutcs&#39;: 6, &#39;rsutcsaf&#39;: 6, &#39;sbl&#39;: 11, &#39;sfcWind&#39;: 7, &#39;sfcWindmax&#39;: 12, &#39;sfdsi&#39;: 6, &#39;siage&#39;: 1, &#39;siareaacrossline&#39;: 1, &#39;siarean&#39;: 1, &#39;siareas&#39;: 1, &#39;sicompstren&#39;: 1, &#39;siconc&#39;: 7, &#39;siconca&#39;: 2, &#39;sidconcdyn&#39;: 1, &#39;sidconcth&#39;: 1, &#39;sidmassdyn&#39;: 1, &#39;sidmassevapsubl&#39;: 1, &#39;sidmassgrowthbot&#39;: 1, &#39;sidmassgrowthwat&#39;: 1, &#39;sidmasslat&#39;: 1, &#39;sidmassmeltbot&#39;: 1, &#39;sidmassmelttop&#39;: 1, &#39;sidmasssi&#39;: 1, &#39;sidmassth&#39;: 1, &#39;sidmasstranx&#39;: 1, &#39;sidmasstrany&#39;: 1, &#39;sidragbot&#39;: 1, &#39;siextentn&#39;: 1, &#39;siextents&#39;: 1, &#39;sifb&#39;: 1, &#39;siflcondbot&#39;: 1, &#39;siflcondtop&#39;: 1, &#39;siflfwbot&#39;: 1, &#39;siflfwdrain&#39;: 1, &#39;sifllatstop&#39;: 1, &#39;sifllwutop&#39;: 1, &#39;siflsensupbot&#39;: 1, &#39;siflswdbot&#39;: 1, &#39;siflswdtop&#39;: 1, &#39;siflswutop&#39;: 1, &#39;sihc&#39;: 1, &#39;simass&#39;: 1, &#39;simassacrossline&#39;: 1, &#39;sipr&#39;: 1, &#39;sisali&#39;: 1, &#39;sisaltmass&#39;: 1, &#39;sisnconc&#39;: 1, &#39;sisnhc&#39;: 1, &#39;sisnmass&#39;: 1, &#39;sisnthick&#39;: 7, &#39;sispeed&#39;: 2, &#39;sistrxdtop&#39;: 1, &#39;sistrxubot&#39;: 1, &#39;sistrydtop&#39;: 1, &#39;sistryubot&#39;: 1, &#39;sitempbot&#39;: 1, &#39;sitempsnic&#39;: 1, &#39;sitemptop&#39;: 2, &#39;sithick&#39;: 7, &#39;sitimefrac&#39;: 2, &#39;siu&#39;: 6, &#39;siv&#39;: 7, &#39;sivol&#39;: 6, &#39;sivoln&#39;: 1, &#39;sivols&#39;: 1, &#39;sltbasin&#39;: 1, &#39;sltnortha&#39;: 1, &#39;sltovgyre&#39;: 5, &#39;sltovovrt&#39;: 6, &#39;snc&#39;: 12, &#39;snd&#39;: 6, &#39;sndmassdyn&#39;: 1, &#39;sndmassmelt&#39;: 1, &#39;sndmasssi&#39;: 1, &#39;sndmasssnf&#39;: 1, &#39;sndmasssubl&#39;: 1, &#39;snm&#39;: 6, &#39;snmassacrossline&#39;: 1, &#39;snw&#39;: 6, &#39;so&#39;: 6, &#39;sob&#39;: 6, &#39;soga&#39;: 6, &#39;sos&#39;: 6, &#39;sosga&#39;: 6, &#39;t20d&#39;: 6, &#39;ta&#39;: 10, &#39;ta500&#39;: 1, &#39;ta850&#39;: 1, &#39;tas&#39;: 13, &#39;tasmax&#39;: 6, &#39;tasmin&#39;: 7, &#39;tauu&#39;: 6, &#39;tauuo&#39;: 6, &#39;tauv&#39;: 6, &#39;tauvo&#39;: 6, &#39;thetao&#39;: 6, &#39;thetaoga&#39;: 6, &#39;thetaot&#39;: 1, &#39;thkcello&#39;: 6, &#39;tntrl&#39;: 1, &#39;tob&#39;: 6, &#39;tos&#39;: 12, &#39;tosga&#39;: 6, &#39;tossq&#39;: 6, &#39;toz&#39;: 6, &#39;tpf&#39;: 6, &#39;tran&#39;: 6, &#39;treeFrac&#39;: 6, &#39;ts&#39;: 6, &#39;tsl&#39;: 6, &#39;tslsi&#39;: 1, &#39;tsn&#39;: 6, &#39;ua&#39;: 12, &#39;uas&#39;: 14, &#39;umo&#39;: 6, &#39;uo&#39;: 6, &#39;va&#39;: 12, &#39;vas&#39;: 14, &#39;vegFrac&#39;: 6, &#39;vmo&#39;: 6, &#39;vo&#39;: 5, &#39;volo&#39;: 6, &#39;wap&#39;: 6, &#39;wfo&#39;: 6, &#39;wmo&#39;: 6, &#39;wo&#39;: 6, &#39;wtd&#39;: 6, &#39;zg&#39;: 13, &#39;zg500&#39;: 1, &#39;zos&#39;: 6, &#39;zossq&#39;: 6, &#39;zostoga&#39;: 6, &#39;ztp&#39;: 6}, &#39;frequency&#39;: {&#39;3hr&#39;: 8, &#39;3hrPt&#39;: 4, &#39;6hrPt&#39;: 4, &#39;day&#39;: 190, &#39;fx&#39;: 6, &#39;mon&#39;: 1053}}
</pre></div>
</div>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="freva.esgf_query">
<span class="sig-prename descclassname"><span class="pre">freva.</span></span><span class="sig-name descname"><span class="pre">esgf_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">search_constraints</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#freva.esgf_query" title="Link to this definition">#</a></dt>
<dd><p>Query fields from ESGF and group them per dataset</p>
<p>The method queries fields (e.g. facets) and groups them by dataset
in a list of dictionaries.</p>
<section id="id23">
<h3>Parameters:<a class="headerlink" href="#id23" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>query:</dt><dd><p>Display results from &lt;list&gt; queried fields</p>
</dd>
<dt><a href="#id24"><span class="problematic" id="id25">**</span></a>search_constraints:</dt><dd><p>Search facets to be applied in the data search.</p>
</dd>
</dl>
</section>
<section id="id26">
<h3>Returns:<a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>list[dict[str, list[str]]]:</dt><dd><p>List of dictionaries with the queried elements for each dataset</p>
</dd>
</dl>
</section>
<section id="example">
<h3>Example:<a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<p>Show the <code class="docutils literal notranslate"><span class="pre">key=value</span></code> pair of selected elements for a search (e.g.
<code class="docutils literal notranslate"><span class="pre">query=[&quot;url&quot;,&quot;master_id&quot;,&quot;distribution&quot;,&quot;mip_era&quot;,&quot;activity_id&quot;,&quot;source_id&quot;,&quot;variable&quot;,&quot;product&quot;,&quot;version&quot;]</span></code>):</p>
<p><span class="caption-text">Code </span></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span><span class="o">,</span> <span class="nn">freva</span>
<span class="n">queries</span> <span class="o">=</span> <span class="n">freva</span><span class="o">.</span><span class="n">esgf_query</span><span class="p">(</span>
    <span class="n">mip_era</span><span class="o">=</span><span class="s2">&quot;CMIP6&quot;</span><span class="p">,</span>
    <span class="n">activity_id</span><span class="o">=</span><span class="s2">&quot;ScenarioMIP&quot;</span><span class="p">,</span>
    <span class="n">source_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CM6-1&quot;</span><span class="p">,</span>
    <span class="n">institution_id</span><span class="o">=</span><span class="s2">&quot;CNRM-CERFACS&quot;</span><span class="p">,</span>
    <span class="n">experiment_id</span><span class="o">=</span><span class="s2">&quot;ssp585&quot;</span><span class="p">,</span>
    <span class="n">frequency</span><span class="o">=</span><span class="s2">&quot;3hr&quot;</span><span class="p">,</span>
    <span class="n">variant_label</span><span class="o">=</span><span class="s2">&quot;r1i1p1f2&quot;</span><span class="p">,</span>
    <span class="n">distrib</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">latest</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">query</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;url&quot;</span><span class="p">,</span><span class="s2">&quot;master_id&quot;</span><span class="p">,</span><span class="s2">&quot;distribution&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mip_era&quot;</span><span class="p">,</span><span class="s2">&quot;activity_id&quot;</span><span class="p">,</span><span class="s2">&quot;source_id&quot;</span><span class="p">,</span>
        <span class="s2">&quot;variable&quot;</span><span class="p">,</span><span class="s2">&quot;product&quot;</span><span class="p">,</span><span class="s2">&quot;version&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">queries</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">indent</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<p><span class="caption-text">Results</span></p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[
   {
      &quot;version&quot;: &quot;20190219&quot;,
      &quot;activity_id&quot;: [
         &quot;ScenarioMIP&quot;
      ],
      &quot;master_id&quot;: &quot;CMIP6.ScenarioMIP.CNRM-CERFACS.CNRM-CM6-1.ssp585.r1i1p1f2.E3hr.vas.gr&quot;,
      &quot;mip_era&quot;: [
         &quot;CMIP6&quot;
      ],
      &quot;product&quot;: [
         &quot;model-output&quot;
      ],
      &quot;source_id&quot;: [
         &quot;CNRM-CM6-1&quot;
      ],
      &quot;url&quot;: [
         &quot;http://esgf3.dkrz.de/thredds/catalog/esgcet/1586/CMIP6.ScenarioMIP.CNRM-CERFACS.CNRM-CM6-1.ssp585.r1i1p1f2.E3hr.vas.gr.v20190219.xml#CMIP6.ScenarioMIP.CNRM-CERFACS.CNRM-CM6-1.ssp585.r1i1p1f2.E3hr.vas.gr.v20190219|application/xml+thredds|THREDDS&quot;,
         &quot;http://esgf3.dkrz.de/las/getUI.do?catid=649F6BBCDD98B0633CF0042D119CC69D_ns_CMIP6.ScenarioMIP.CNRM-CERFACS.CNRM-CM6-1.ssp585.r1i1p1f2.E3hr.vas.gr.v20190219|application/las|LAS&quot;
      ],
      &quot;variable&quot;: [
         &quot;vas&quot;
      ],
      &quot;score&quot;: 1.0
   },
   {
      &quot;version&quot;: &quot;20190219&quot;,
      &quot;activity_id&quot;: [
         &quot;ScenarioMIP&quot;
      ],
      &quot;master_id&quot;: &quot;CMIP6.ScenarioMIP.CNRM-CERFACS.CNRM-CM6-1.ssp585.r1i1p1f2.E3hr.prrc.gr&quot;,
      &quot;mip_era&quot;: [
         &quot;CMIP6&quot;
      ],
      &quot;product&quot;: [
         &quot;model-output&quot;
      ],
      &quot;source_id&quot;: [
         &quot;CNRM-CM6-1&quot;
      ],
      &quot;url&quot;: [
         &quot;http://esgf3.dkrz.de/thredds/catalog/esgcet/1586/CMIP6.ScenarioMIP.CNRM-CERFACS.CNRM-CM6-1.ssp585.r1i1p1f2.E3hr.prrc.gr.v20190219.xml#CMIP6.ScenarioMIP.CNRM-CERFACS.CNRM-CM6-1.ssp585.r1i1p1f2.E3hr.prrc.gr.v20190219|application/xml+thredds|THREDDS&quot;,
         &quot;http://esgf3.dkrz.de/las/getUI.do?catid=649F6BBCDD98B0633CF0042D119CC69D_ns_CMIP6.ScenarioMIP.CNRM-CERFACS.CNRM-CM6-1.ssp585.r1i1p1f2.E3hr.prrc.gr.v20190219|application/las|LAS&quot;
      ],
      &quot;variable&quot;: [
         &quot;prrc&quot;
      ],
      &quot;score&quot;: 1.0
   }
]
</pre></div>
</div>
</section>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to Freva’s documentation!</p>
      </div>
    </a>
    <a class="right-next"
       href="FrevaCli.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">The Freva command line interface</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-data">Searching for data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.count_values"><code class="docutils literal notranslate"><span class="pre">count_values()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.databrowser"><code class="docutils literal notranslate"><span class="pre">databrowser()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.facet_search"><code class="docutils literal notranslate"><span class="pre">facet_search()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-analysis-plugins">Running analysis plugins</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.get_tools_list"><code class="docutils literal notranslate"><span class="pre">get_tools_list()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.list_plugins"><code class="docutils literal notranslate"><span class="pre">list_plugins()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.plugin_doc"><code class="docutils literal notranslate"><span class="pre">plugin_doc()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.run_plugin"><code class="docutils literal notranslate"><span class="pre">run_plugin()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus"><code class="docutils literal notranslate"><span class="pre">PluginStatus</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.batch_id"><code class="docutils literal notranslate"><span class="pre">PluginStatus.batch_id</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.configuration"><code class="docutils literal notranslate"><span class="pre">PluginStatus.configuration</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.get_result_paths"><code class="docutils literal notranslate"><span class="pre">PluginStatus.get_result_paths()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.job_script"><code class="docutils literal notranslate"><span class="pre">PluginStatus.job_script</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.kill"><code class="docutils literal notranslate"><span class="pre">PluginStatus.kill()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.plugin"><code class="docutils literal notranslate"><span class="pre">PluginStatus.plugin</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.status"><code class="docutils literal notranslate"><span class="pre">PluginStatus.status</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.stdout"><code class="docutils literal notranslate"><span class="pre">PluginStatus.stdout</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.version"><code class="docutils literal notranslate"><span class="pre">PluginStatus.version</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.PluginStatus.wait"><code class="docutils literal notranslate"><span class="pre">PluginStatus.wait()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-2">Accessing the previous plugin runs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.history"><code class="docutils literal notranslate"><span class="pre">history()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-3">The <code class="docutils literal notranslate"><span class="pre">UserData</span></code> class</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.UserData"><code class="docutils literal notranslate"><span class="pre">UserData</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.UserData.add"><code class="docutils literal notranslate"><span class="pre">UserData.add()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.UserData.delete"><code class="docutils literal notranslate"><span class="pre">UserData.delete()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.UserData.index"><code class="docutils literal notranslate"><span class="pre">UserData.index()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.UserData.user_dir"><code class="docutils literal notranslate"><span class="pre">UserData.user_dir</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overriding-or-using-a-freva-configuration">Overriding or using a freva configuration</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.config"><code class="docutils literal notranslate"><span class="pre">config</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.config.db_reloaded"><code class="docutils literal notranslate"><span class="pre">config.db_reloaded</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#searching-for-esgf-data">Searching for ESGF data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.esgf_browser"><code class="docutils literal notranslate"><span class="pre">esgf_browser()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.esgf_datasets"><code class="docutils literal notranslate"><span class="pre">esgf_datasets()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.esgf_download"><code class="docutils literal notranslate"><span class="pre">esgf_download()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.esgf_facets"><code class="docutils literal notranslate"><span class="pre">esgf_facets()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#freva.esgf_query"><code class="docutils literal notranslate"><span class="pre">esgf_query()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=3ee479438cf8b5e0d341"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=3ee479438cf8b5e0d341"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, DKRZ.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.3.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>